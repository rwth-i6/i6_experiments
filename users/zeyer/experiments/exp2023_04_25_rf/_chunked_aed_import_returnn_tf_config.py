#!rnn.py


def summary(name, x):
    """
    :param str name:
    :param tf.Tensor x: (batch,time,feature)
    """
    from returnn.tf.compat import v1 as tf

    # tf.summary.image wants [batch_size, height,  width, channels],
    # we have (batch, time, feature).
    img = tf.expand_dims(x, axis=3)  # (batch,time,feature,1)
    img = tf.transpose(img, [0, 2, 1, 3])  # (batch,feature,time,1)
    tf.summary.image(name, img, max_outputs=10)
    tf.summary.scalar("%s_max_abs" % name, tf.reduce_max(tf.abs(x)))
    mean = tf.reduce_mean(x)
    tf.summary.scalar("%s_mean" % name, mean)
    stddev = tf.sqrt(tf.reduce_mean(tf.square(x - mean)))
    tf.summary.scalar("%s_stddev" % name, stddev)
    tf.summary.histogram("%s_hist" % name, tf.reduce_max(tf.abs(x), axis=2))


def _mask(x, batch_axis, axis, pos, max_amount):
    """
    :param tf.Tensor x: (batch,time,feature)
    :param int batch_axis:
    :param int axis:
    :param tf.Tensor pos: (batch,)
    :param int|tf.Tensor max_amount: inclusive
    """
    from returnn.tf.compat import v1 as tf

    ndim = x.get_shape().ndims
    n_batch = tf.shape(x)[batch_axis]
    dim = tf.shape(x)[axis]
    amount = tf.random_uniform(
        shape=(n_batch,), minval=1, maxval=max_amount + 1, dtype=tf.int32
    )
    pos2 = tf.minimum(pos + amount, dim)
    idxs = tf.expand_dims(tf.range(0, dim), 0)  # (1,dim)
    pos_bc = tf.expand_dims(pos, 1)  # (batch,1)
    pos2_bc = tf.expand_dims(pos2, 1)  # (batch,1)
    cond = tf.logical_and(
        tf.greater_equal(idxs, pos_bc), tf.less(idxs, pos2_bc)
    )  # (batch,dim)
    if batch_axis > axis:
        cond = tf.transpose(cond)  # (dim,batch)
    cond = tf.reshape(
        cond, [tf.shape(x)[i] if i in (batch_axis, axis) else 1 for i in range(ndim)]
    )
    from TFUtil import where_bc

    x = where_bc(cond, 0.0, x)
    return x


def random_mask(x, batch_axis, axis, min_num, max_num, max_dims):
    """
    :param tf.Tensor x: (batch,time,feature)
    :param int batch_axis:
    :param int axis:
    :param int|tf.Tensor min_num:
    :param int|tf.Tensor max_num: inclusive
    :param int|tf.Tensor max_dims: inclusive
    """
    from returnn.tf.compat import v1 as tf

    n_batch = tf.shape(x)[batch_axis]
    if isinstance(min_num, int) and isinstance(max_num, int) and min_num == max_num:
        num = min_num
    else:
        num = tf.random_uniform(
            shape=(n_batch,), minval=min_num, maxval=max_num + 1, dtype=tf.int32
        )
    # https://github.com/tensorflow/tensorflow/issues/9260
    # https://timvieira.github.io/blog/post/2014/08/01/gumbel-max-trick-and-weighted-reservoir-sampling/
    z = -tf.log(-tf.log(tf.random_uniform((n_batch, tf.shape(x)[axis]), 0, 1)))
    _, indices = tf.nn.top_k(z, num if isinstance(num, int) else tf.reduce_max(num))
    # indices should be sorted, and of shape (batch,num), entries (int32) in [0,dim)
    # indices = tf.Print(indices, ["indices", indices, tf.shape(indices)])
    if isinstance(num, int):
        for i in range(num):
            x = _mask(
                x,
                batch_axis=batch_axis,
                axis=axis,
                pos=indices[:, i],
                max_amount=max_dims,
            )
    else:
        _, x = tf.while_loop(
            cond=lambda i, _: tf.less(i, tf.reduce_max(num)),
            body=lambda i, x: (
                i + 1,
                tf.where(
                    tf.less(i, num),
                    _mask(
                        x,
                        batch_axis=batch_axis,
                        axis=axis,
                        pos=indices[:, i],
                        max_amount=max_dims,
                    ),
                    x,
                ),
            ),
            loop_vars=(0, x),
        )
    return x


def transform(data, network, time_factor=1):
    x = data.placeholder
    from returnn.tf.compat import v1 as tf

    # summary("features", x)
    step = network.global_train_step
    step1 = tf.where(tf.greater_equal(step, 1000), 1, 0)
    step2 = tf.where(tf.greater_equal(step, 2000), 1, 0)

    def get_masked():
        x_masked = x
        x_masked = random_mask(
            x_masked,
            batch_axis=data.batch_dim_axis,
            axis=data.time_dim_axis,
            min_num=step1 + step2,
            max_num=tf.maximum(tf.shape(x)[data.time_dim_axis] // 100, 2)
            * (1 + step1 + step2 * 2),
            max_dims=20 // time_factor,
        )
        x_masked = random_mask(
            x_masked,
            batch_axis=data.batch_dim_axis,
            axis=data.feature_dim_axis,
            min_num=step1 + step2,
            max_num=2 + step1 + step2 * 2,
            max_dims=data.dim // 5,
        )
        # summary("features_mask", x_masked)
        return x_masked

    x = network.cond_on_train(get_masked, lambda: x)
    return x


from returnn.tf.util.data import (
    Dim,
    batch_dim,
    single_step_dim,
    SpatialDim,
    FeatureDim,
    ImplicitDynSizeDim,
    ImplicitSparseDim,
)


subsample_conv0_0_dim = Dim(kind=None, description="subsample_conv0.0", dimension=None)
subsample_conv0_1_dim = Dim(kind=None, description="subsample_conv0.1", dimension=None)
subsample_conv0_out_dim = Dim(
    kind=None, description="subsample_conv0.out", dimension=64
)
subsample_conv1_0_dim = Dim(kind=None, description="subsample_conv1.0", dimension=None)
subsample_conv1_1_dim = Dim(kind=None, description="subsample_conv1.1", dimension=None)
subsample_conv1_out_dim = Dim(
    kind=None, description="subsample_conv1.out", dimension=64
)
enc_dim_per_head_dim = FeatureDim("enc-dim-per-head", 64)
chunk_size_dim = SpatialDim("chunk-size", 35)
concat_window_dim = SpatialDim("concat-window")
chunked_time_dim = SpatialDim("chunked-time")
enc_att_num_heads_dim = SpatialDim("enc-att-num-heads", 8)
conv_cache_concat_dim = SpatialDim("conv-cache-concat")
input_chunk_size_dim = SpatialDim("input-chunk-size", 210)
sliced_chunk_size_dim = SpatialDim("sliced-chunk-size", 20)
dec_att_num_heads_dim = SpatialDim("dec-att-num-heads", 1)
val_dim = FeatureDim("val", 512)


def load_qkv_mats(name, shape, reader):
    if not name.startswith("conformer_block_"):
        return None

    idx = name.split("_")[2]
    qkv_tensor = reader.get_tensor("conformer_block_%s_self_att/QKV" % idx)
    num_heads = enc_att_num_heads_dim.dimension
    model_dim_per_head = enc_dim_per_head_dim.dimension
    model_dim = num_heads * model_dim_per_head
    assert qkv_tensor.shape == (model_dim, 3 * model_dim)
    import numpy

    qkv_tensor_ = qkv_tensor.reshape((model_dim, num_heads, 3, model_dim_per_head))
    q = qkv_tensor_[:, :, 0, :].reshape((model_dim, model_dim))
    k = qkv_tensor_[:, :, 1, :].reshape((model_dim, model_dim))
    v = qkv_tensor_[:, :, 2, :].reshape((model_dim, model_dim))

    if name == "conformer_block_%s_self_att_ln_K/W" % idx:
        return k
    elif name == "conformer_block_%s_self_att_ln_Q/W" % idx:
        return q
    elif name == "conformer_block_%s_self_att_ln_V/W" % idx:
        return v
    return None


accum_grad_multiple_step = 2
adam = True
batch_size = 2400000
batching = "random"
cleanup_old_models = True
debug_mode = False
debug_print_layer_output_template = True
dev = {
    "class": "MetaDataset",
    "data_map": {
        "audio_features": ("zip_dataset", "data"),
        "bpe_labels": ("chunk_hdf_dataset", "data"),
    },
    "datasets": {
        "chunk_hdf_dataset": {
            "class": "HDFDataset",
            "files": [
                "/u/zeineldeen/setups/ubuntu_22_setups/2023-06-14--streaming-conf/work/i6_core/returnn/forward/ReturnnForwardJob.u14J5Lpd0X8X/output/alignments-dev.hdf"
            ],
            "partition_epoch": 1,
            "use_cache_manager": True,
        },
        "zip_dataset": {
            "audio": {
                "features": "raw",
                "peak_normalization": True,
                "preemphasis": None,
            },
            "class": "OggZipDataset",
            "partition_epoch": 1,
            "path": [
                "/u/zeineldeen/setups/ubuntu_22_setups/2023-06-14--streaming-conf/work/i6_core/returnn/oggzip/BlissToOggZipJob.RvwLniNrgMit/output/out.ogg.zip",
                "/u/zeineldeen/setups/ubuntu_22_setups/2023-06-14--streaming-conf/work/i6_core/returnn/oggzip/BlissToOggZipJob.NSdIHfk1iw2M/output/out.ogg.zip",
            ],
            "segment_file": "/u/zeineldeen/setups/ubuntu_22_setups/2023-06-14--streaming-conf/work/i6_core/text/processing/PipelineJob.gTty7UHs0uBu/output/out",
            "seq_ordering": "sorted_reverse",
            "targets": None,
            "use_cache_manager": True,
        },
    },
    "seq_order_control_dataset": "zip_dataset",
}
device = "gpu"
extern_data = {
    "audio_features": {"available_for_inference": True, "dim": 1, "shape": (None, 1)},
    "bpe_labels": {
        "available_for_inference": False,
        "dim": 10025,
        "shape": (None,),
        "sparse": True,
    },
}
gradient_clip = 0.0
gradient_noise = 0.0
learning_rate = 0.0008
learning_rate_control = "newbob_multi_epoch"
learning_rate_control_min_num_epochs_per_new_lr = 3
learning_rate_control_relative_error_relative_lr = True
learning_rate_file = "learning_rates"
learning_rates = [
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.0002,
    0.000199,
    0.00019800000000000002,
    0.00019700000000000002,
    0.00019600000000000002,
    0.000195,
    0.000194,
    0.000193,
    0.000192,
    0.000191,
    0.00019,
    0.000189,
    0.00018800000000000002,
    0.00018700000000000002,
    0.00018600000000000002,
    0.000185,
    0.000184,
    0.000183,
    0.000182,
    0.000181,
    0.00018,
    0.00017900000000000001,
    0.00017800000000000002,
    0.00017700000000000002,
    0.000176,
    0.000175,
    0.000174,
    0.000173,
    0.000172,
    0.000171,
    0.00017,
    0.000169,
    0.00016800000000000002,
    0.000167,
    0.000166,
    0.000165,
    0.000164,
    0.000163,
    0.000162,
    0.000161,
    0.00015999999999999999,
    0.00015900000000000002,
    0.000158,
    0.000157,
    0.000156,
    0.000155,
    0.000154,
    0.000153,
    0.000152,
    0.000151,
    0.00015000000000000001,
    0.000149,
    0.000148,
    0.000147,
    0.000146,
    0.000145,
    0.000144,
    0.000143,
    0.000142,
    0.000141,
    0.00014,
    0.000139,
    0.000138,
    0.000137,
    0.000136,
    0.000135,
    0.000134,
    0.00013299999999999998,
    0.000132,
    0.00013099999999999999,
    0.00013000000000000002,
    0.000129,
    0.000128,
    0.000127,
    0.000126,
    0.000125,
    0.00012399999999999998,
    0.000123,
    0.000122,
    0.000121,
    0.00011999999999999999,
    0.00011899999999999999,
    0.000118,
    0.000117,
    0.000116,
    0.00011499999999999999,
    0.00011399999999999999,
    0.000113,
    0.000112,
    0.000111,
    0.00010999999999999999,
    0.00010899999999999999,
    0.000108,
    0.000107,
    0.00010599999999999999,
    0.00010499999999999999,
    0.000104,
    0.000103,
    0.000102,
    0.00010099999999999999,
    9.999999999999999e-05,
    9.9e-05,
    9.8e-05,
    9.699999999999999e-05,
    9.599999999999999e-05,
    9.499999999999999e-05,
    9.4e-05,
    9.3e-05,
    9.199999999999999e-05,
    9.099999999999999e-05,
    8.999999999999999e-05,
    8.9e-05,
    8.8e-05,
    8.699999999999999e-05,
    8.599999999999999e-05,
    8.499999999999999e-05,
    8.4e-05,
    8.299999999999998e-05,
    8.199999999999999e-05,
    8.099999999999999e-05,
    7.999999999999999e-05,
    7.9e-05,
    7.799999999999999e-05,
    7.7e-05,
    7.599999999999998e-05,
    7.499999999999998e-05,
    7.399999999999998e-05,
    7.299999999999999e-05,
    7.199999999999999e-05,
    7.099999999999999e-05,
    7e-05,
    6.9e-05,
    6.8e-05,
    6.699999999999998e-05,
    6.599999999999998e-05,
    6.499999999999998e-05,
    6.399999999999998e-05,
    6.299999999999999e-05,
    6.199999999999999e-05,
    6.099999999999999e-05,
    5.9999999999999995e-05,
    5.9e-05,
    5.799999999999997e-05,
    5.6999999999999976e-05,
    5.599999999999998e-05,
    5.499999999999998e-05,
    5.3999999999999984e-05,
    5.299999999999999e-05,
    5.199999999999999e-05,
    5.099999999999999e-05,
    4.9999999999999996e-05,
    4.899999999999997e-05,
    4.7999999999999974e-05,
    4.699999999999998e-05,
    4.599999999999998e-05,
    4.499999999999998e-05,
    4.3999999999999985e-05,
    4.299999999999999e-05,
    4.199999999999999e-05,
    4.0999999999999994e-05,
    3.999999999999997e-05,
    3.899999999999997e-05,
    3.7999999999999975e-05,
    3.699999999999998e-05,
    3.599999999999998e-05,
    3.499999999999998e-05,
    3.3999999999999986e-05,
    3.299999999999999e-05,
    3.199999999999999e-05,
    3.0999999999999995e-05,
    2.999999999999997e-05,
    2.8999999999999973e-05,
    2.7999999999999976e-05,
    2.699999999999998e-05,
    2.599999999999998e-05,
    2.4999999999999984e-05,
    2.3999999999999987e-05,
    2.299999999999999e-05,
    2.1999999999999993e-05,
    2.099999999999997e-05,
    1.999999999999997e-05,
    1.8999999999999974e-05,
    1.7999999999999977e-05,
    1.699999999999998e-05,
    1.5999999999999982e-05,
    1.4999999999999985e-05,
    1.3999999999999988e-05,
    1.299999999999999e-05,
    1.1999999999999966e-05,
    1.099999999999997e-05,
    9.999999999999972e-06,
    8.999999999999975e-06,
    7.999999999999978e-06,
    6.99999999999998e-06,
    5.999999999999983e-06,
    4.999999999999986e-06,
    3.999999999999989e-06,
    2.9999999999999645e-06,
    1.9999999999999673e-06,
    1e-06,
]
log = ["./returnn.log"]
log_batch_size = True
log_verbosity = 5
max_seqs = 200
min_learning_rate = 1.6e-05
model = "/u/zeineldeen/setups/ubuntu_22_setups/2023-06-14--streaming-conf/work/i6_core/returnn/training/ReturnnTrainingJob.ThjimHBUuNFA/output/models/epoch"
network = {
    "___encoder": {
        "axis": chunk_size_dim,
        "class": "slice",
        "from": "__encoder",
        "out_dim": sliced_chunk_size_dim,
        "slice_end": 20,
        "slice_start": 0,
    },
    "__encoder": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "_encoder",
    },
    "__input_chunked": {
        "axes": ["B", chunked_time_dim],
        "class": "merge_dims",
        "from": "_input_chunked",
        "keep_order": True,
    },
    "_encoder": {
        "class": "reinterpret_data",
        "from": "encoder_full_seq",
        "set_dim_tags": {"T": chunk_size_dim},
    },
    "_input_chunked": {
        "class": "window",
        "from": "source",
        "out_spatial_dim": chunked_time_dim,
        "stride": 120,
        "window_dim": input_chunk_size_dim,
        "window_left": 0,
    },
    "abs": {"activation": "abs", "class": "activation", "from": "stft"},
    "conformer_block_01": {"class": "copy", "from": "conformer_block_01_ln"},
    "conformer_block_01_conv_mod_bn": {
        "class": "batch_norm",
        "delay_sample_update": True,
        "epsilon": 0.001,
        "from": "conformer_block_01_conv_mod_depthwise_conv_slice",
        "momentum": 0.1,
        "update_sample_only_in_training": True,
    },
    "conformer_block_01_conv_mod_depthwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "conv",
        "filter_size": (32,),
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_01_conv_mod_glu_act_concat",
        "groups": 512,
        "n_out": 512,
        "padding": "same",
        "with_bias": True,
    },
    "conformer_block_01_conv_mod_depthwise_conv_slice": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_01_conv_mod_depthwise_conv2",
        "slice_start": 40,
    },
    "conformer_block_01_conv_mod_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_01_conv_mod_pointwise_conv2",
    },
    "conformer_block_01_conv_mod_glu": {
        "activation": "identity",
        "class": "gating",
        "from": "conformer_block_01_conv_mod_pointwise_conv1",
    },
    "conformer_block_01_conv_mod_glu_act_chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_01_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_01_conv_mod_glu_act_chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_01_conv_mod_glu_act_chunk_shifted",
    },
    "conformer_block_01_conv_mod_glu_act_chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_01_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_01_conv_mod_glu_act_chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_01_conv_mod_glu_act_chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_01_conv_mod_glu_act_chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_01_conv_mod_glu_act_chunk_shifted_1",
    },
    "conformer_block_01_conv_mod_glu_act_chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_01_conv_mod_glu_act_chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_01_conv_mod_glu_act_chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_01_conv_mod_glu_act_chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_01_conv_mod_glu_act_chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_01_conv_mod_glu_act_chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_01_conv_mod_glu_act_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_01_conv_mod_glu_act_chunk_shifted___1_sliced", "T"),
            ("conformer_block_01_conv_mod_glu_act_chunk_shifted___sliced", "T"),
            ("conformer_block_01_conv_mod_glu", "T"),
        ],
        "out_dim": conv_cache_concat_dim,
    },
    "conformer_block_01_conv_mod_glu_act_split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_01_conv_mod_glu",
    },
    "conformer_block_01_conv_mod_ln": {
        "class": "layer_norm",
        "from": "conformer_block_01_self_att_res",
    },
    "conformer_block_01_conv_mod_pointwise_conv1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_01_conv_mod_ln",
        "n_out": 1024,
        "with_bias": True,
    },
    "conformer_block_01_conv_mod_pointwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_01_conv_mod_swish",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_01_conv_mod_res": {
        "class": "combine",
        "from": ["conformer_block_01_conv_mod_drop", "conformer_block_01_self_att_res"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_01_conv_mod_swish": {
        "activation": "swish",
        "class": "activation",
        "from": "conformer_block_01_conv_mod_bn",
    },
    "conformer_block_01_ffmod_1_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_01_ffmod_1_square_relu",
    },
    "conformer_block_01_ffmod_1_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_01_ffmod_1_ff2",
    },
    "conformer_block_01_ffmod_1_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_01_ffmod_1_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_01_ffmod_1_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_01_ffmod_1_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_01_ffmod_1_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_01_ffmod_1_drop2",
    },
    "conformer_block_01_ffmod_1_ln": {"class": "layer_norm", "from": "source_dropout"},
    "conformer_block_01_ffmod_1_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_01_ffmod_1_ff1",
    },
    "conformer_block_01_ffmod_1_res": {
        "class": "combine",
        "from": ["conformer_block_01_ffmod_1_half_step", "source_dropout"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_01_ffmod_1_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_01_ffmod_1_relu",
    },
    "conformer_block_01_ffmod_2_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_01_ffmod_2_square_relu",
    },
    "conformer_block_01_ffmod_2_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_01_ffmod_2_ff2",
    },
    "conformer_block_01_ffmod_2_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_01_ffmod_2_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_01_ffmod_2_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_01_ffmod_2_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_01_ffmod_2_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_01_ffmod_2_drop2",
    },
    "conformer_block_01_ffmod_2_ln": {
        "class": "layer_norm",
        "from": "conformer_block_01_conv_mod_res",
    },
    "conformer_block_01_ffmod_2_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_01_ffmod_2_ff1",
    },
    "conformer_block_01_ffmod_2_res": {
        "class": "combine",
        "from": [
            "conformer_block_01_ffmod_2_half_step",
            "conformer_block_01_conv_mod_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_01_ffmod_2_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_01_ffmod_2_relu",
    },
    "conformer_block_01_ln": {
        "class": "layer_norm",
        "from": "conformer_block_01_ffmod_2_res",
    },
    "conformer_block_01_self_att_Q_energy_factor": {
        "class": "eval",
        "eval": "source(0) ** -0.5",
        "from": "conformer_block_01_self_att_dim_per_head_const",
    },
    "conformer_block_01_self_att_dim_per_head_const": {
        "class": "constant",
        "dtype": "float32",
        "value": 64,
    },
    "conformer_block_01_self_att_dropout": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_01_self_att_linear",
    },
    "conformer_block_01_self_att_linear": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_01_self_att_ln_att",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_01_self_att_ln": {
        "class": "layer_norm",
        "from": "conformer_block_01_ffmod_1_res",
    },
    "conformer_block_01_self_att_ln_K": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_01_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_01_self_att_ln_K_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_01_self_att_ln_K_concat",
    },
    "conformer_block_01_self_att_ln_K__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_01_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_01_self_att_ln_K__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_01_self_att_ln_K__chunk_shifted",
    },
    "conformer_block_01_self_att_ln_K__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_01_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_01_self_att_ln_K__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_01_self_att_ln_K__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_01_self_att_ln_K__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_01_self_att_ln_K__chunk_shifted_1",
    },
    "conformer_block_01_self_att_ln_K__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_01_self_att_ln_K__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_01_self_att_ln_K__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_01_self_att_ln_K__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_01_self_att_ln_K__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_01_self_att_ln_K__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_01_self_att_ln_K__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_01_self_att_ln_K",
    },
    "conformer_block_01_self_att_ln_K_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_01_self_att_ln_K__chunk_shifted___1_sliced", "T"),
            ("conformer_block_01_self_att_ln_K__chunk_shifted___sliced", "T"),
            ("conformer_block_01_self_att_ln_K", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_01_self_att_ln_Q": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_01_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_01_self_att_ln_Q_H": {
        "class": "combine",
        "from": [
            "conformer_block_01_self_att_ln_Q_H_",
            "conformer_block_01_self_att_Q_energy_factor",
        ],
        "kind": "mul",
    },
    "conformer_block_01_self_att_ln_Q_H_": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_01_self_att_ln_Q",
    },
    "conformer_block_01_self_att_ln_V": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_01_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_01_self_att_ln_V_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_01_self_att_ln_V_concat",
    },
    "conformer_block_01_self_att_ln_V__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_01_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_01_self_att_ln_V__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_01_self_att_ln_V__chunk_shifted",
    },
    "conformer_block_01_self_att_ln_V__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_01_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_01_self_att_ln_V__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_01_self_att_ln_V__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_01_self_att_ln_V__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_01_self_att_ln_V__chunk_shifted_1",
    },
    "conformer_block_01_self_att_ln_V__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_01_self_att_ln_V__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_01_self_att_ln_V__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_01_self_att_ln_V__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_01_self_att_ln_V__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_01_self_att_ln_V__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_01_self_att_ln_V__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_01_self_att_ln_V",
    },
    "conformer_block_01_self_att_ln_V_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_01_self_att_ln_V__chunk_shifted___1_sliced", "T"),
            ("conformer_block_01_self_att_ln_V__chunk_shifted___sliced", "T"),
            ("conformer_block_01_self_att_ln_V", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_01_self_att_ln_att": {
        "class": "reinterpret_data",
        "from": "conformer_block_01_self_att_ln_att_",
        "set_axes": {"T": "dim:35"},
    },
    "conformer_block_01_self_att_ln_att0": {
        "class": "dot",
        "from": [
            "conformer_block_01_self_att_ln_weights_drop",
            "conformer_block_01_self_att_ln_V_H",
        ],
        "reduce": concat_window_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_01_self_att_ln_att_": {
        "axes": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "class": "merge_dims",
        "from": "conformer_block_01_self_att_ln_att0",
    },
    "conformer_block_01_self_att_ln_energy": {
        "class": "dot",
        "from": [
            "conformer_block_01_self_att_ln_K_H",
            "conformer_block_01_self_att_ln_Q_H",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_01_self_att_ln_energy_": {
        "allow_broadcast_all_sources": False,
        "class": "combine",
        "from": [
            "conformer_block_01_self_att_ln_energy",
            "conformer_block_01_self_att_ln_energy_rel_pos",
        ],
        "kind": "add",
    },
    "conformer_block_01_self_att_ln_energy_rel_pos": {
        "class": "dot",
        "from": [
            "conformer_block_01_self_att_ln_Q_H",
            "conformer_block_01_self_att_ln_rel_pos_enc",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_01_self_att_ln_rel_pos_enc": {
        "class": "relative_positional_encoding",
        "clipping": 16,
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_01_self_att_ln_K_concat",
        "key_value_spatial_dim": concat_window_dim,
        "out_dim": enc_dim_per_head_dim,
        "query_offset": 70,
        "query_spatial_dim": chunk_size_dim,
    },
    "conformer_block_01_self_att_ln_weights": {
        "class": "softmax_over_spatial",
        "from": "conformer_block_01_self_att_ln_energy_",
    },
    "conformer_block_01_self_att_ln_weights_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "dropout_noise_shape": {"*": None},
        "from": "conformer_block_01_self_att_ln_weights",
    },
    "conformer_block_01_self_att_res": {
        "class": "combine",
        "from": [
            "conformer_block_01_self_att_dropout",
            "conformer_block_01_ffmod_1_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_02": {"class": "copy", "from": "conformer_block_02_ln"},
    "conformer_block_02_conv_mod_bn": {
        "class": "batch_norm",
        "delay_sample_update": True,
        "epsilon": 0.001,
        "from": "conformer_block_02_conv_mod_depthwise_conv_slice",
        "momentum": 0.1,
        "update_sample_only_in_training": True,
    },
    "conformer_block_02_conv_mod_depthwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "conv",
        "filter_size": (32,),
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_02_conv_mod_glu_act_concat",
        "groups": 512,
        "n_out": 512,
        "padding": "same",
        "with_bias": True,
    },
    "conformer_block_02_conv_mod_depthwise_conv_slice": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_02_conv_mod_depthwise_conv2",
        "slice_start": 40,
    },
    "conformer_block_02_conv_mod_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_02_conv_mod_pointwise_conv2",
    },
    "conformer_block_02_conv_mod_glu": {
        "activation": "identity",
        "class": "gating",
        "from": "conformer_block_02_conv_mod_pointwise_conv1",
    },
    "conformer_block_02_conv_mod_glu_act_chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_02_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_02_conv_mod_glu_act_chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_02_conv_mod_glu_act_chunk_shifted",
    },
    "conformer_block_02_conv_mod_glu_act_chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_02_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_02_conv_mod_glu_act_chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_02_conv_mod_glu_act_chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_02_conv_mod_glu_act_chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_02_conv_mod_glu_act_chunk_shifted_1",
    },
    "conformer_block_02_conv_mod_glu_act_chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_02_conv_mod_glu_act_chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_02_conv_mod_glu_act_chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_02_conv_mod_glu_act_chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_02_conv_mod_glu_act_chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_02_conv_mod_glu_act_chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_02_conv_mod_glu_act_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_02_conv_mod_glu_act_chunk_shifted___1_sliced", "T"),
            ("conformer_block_02_conv_mod_glu_act_chunk_shifted___sliced", "T"),
            ("conformer_block_02_conv_mod_glu", "T"),
        ],
        "out_dim": conv_cache_concat_dim,
    },
    "conformer_block_02_conv_mod_glu_act_split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_02_conv_mod_glu",
    },
    "conformer_block_02_conv_mod_ln": {
        "class": "layer_norm",
        "from": "conformer_block_02_self_att_res",
    },
    "conformer_block_02_conv_mod_pointwise_conv1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_02_conv_mod_ln",
        "n_out": 1024,
        "with_bias": True,
    },
    "conformer_block_02_conv_mod_pointwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_02_conv_mod_swish",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_02_conv_mod_res": {
        "class": "combine",
        "from": ["conformer_block_02_conv_mod_drop", "conformer_block_02_self_att_res"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_02_conv_mod_swish": {
        "activation": "swish",
        "class": "activation",
        "from": "conformer_block_02_conv_mod_bn",
    },
    "conformer_block_02_ffmod_1_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_02_ffmod_1_square_relu",
    },
    "conformer_block_02_ffmod_1_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_02_ffmod_1_ff2",
    },
    "conformer_block_02_ffmod_1_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_02_ffmod_1_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_02_ffmod_1_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_02_ffmod_1_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_02_ffmod_1_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_02_ffmod_1_drop2",
    },
    "conformer_block_02_ffmod_1_ln": {
        "class": "layer_norm",
        "from": "conformer_block_01",
    },
    "conformer_block_02_ffmod_1_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_02_ffmod_1_ff1",
    },
    "conformer_block_02_ffmod_1_res": {
        "class": "combine",
        "from": ["conformer_block_02_ffmod_1_half_step", "conformer_block_01"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_02_ffmod_1_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_02_ffmod_1_relu",
    },
    "conformer_block_02_ffmod_2_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_02_ffmod_2_square_relu",
    },
    "conformer_block_02_ffmod_2_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_02_ffmod_2_ff2",
    },
    "conformer_block_02_ffmod_2_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_02_ffmod_2_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_02_ffmod_2_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_02_ffmod_2_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_02_ffmod_2_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_02_ffmod_2_drop2",
    },
    "conformer_block_02_ffmod_2_ln": {
        "class": "layer_norm",
        "from": "conformer_block_02_conv_mod_res",
    },
    "conformer_block_02_ffmod_2_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_02_ffmod_2_ff1",
    },
    "conformer_block_02_ffmod_2_res": {
        "class": "combine",
        "from": [
            "conformer_block_02_ffmod_2_half_step",
            "conformer_block_02_conv_mod_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_02_ffmod_2_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_02_ffmod_2_relu",
    },
    "conformer_block_02_ln": {
        "class": "layer_norm",
        "from": "conformer_block_02_ffmod_2_res",
    },
    "conformer_block_02_self_att_Q_energy_factor": {
        "class": "eval",
        "eval": "source(0) ** -0.5",
        "from": "conformer_block_02_self_att_dim_per_head_const",
    },
    "conformer_block_02_self_att_dim_per_head_const": {
        "class": "constant",
        "dtype": "float32",
        "value": 64,
    },
    "conformer_block_02_self_att_dropout": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_02_self_att_linear",
    },
    "conformer_block_02_self_att_linear": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_02_self_att_ln_att",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_02_self_att_ln": {
        "class": "layer_norm",
        "from": "conformer_block_02_ffmod_1_res",
    },
    "conformer_block_02_self_att_ln_K": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_02_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_02_self_att_ln_K_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_02_self_att_ln_K_concat",
    },
    "conformer_block_02_self_att_ln_K__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_02_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_02_self_att_ln_K__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_02_self_att_ln_K__chunk_shifted",
    },
    "conformer_block_02_self_att_ln_K__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_02_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_02_self_att_ln_K__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_02_self_att_ln_K__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_02_self_att_ln_K__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_02_self_att_ln_K__chunk_shifted_1",
    },
    "conformer_block_02_self_att_ln_K__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_02_self_att_ln_K__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_02_self_att_ln_K__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_02_self_att_ln_K__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_02_self_att_ln_K__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_02_self_att_ln_K__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_02_self_att_ln_K__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_02_self_att_ln_K",
    },
    "conformer_block_02_self_att_ln_K_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_02_self_att_ln_K__chunk_shifted___1_sliced", "T"),
            ("conformer_block_02_self_att_ln_K__chunk_shifted___sliced", "T"),
            ("conformer_block_02_self_att_ln_K", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_02_self_att_ln_Q": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_02_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_02_self_att_ln_Q_H": {
        "class": "combine",
        "from": [
            "conformer_block_02_self_att_ln_Q_H_",
            "conformer_block_02_self_att_Q_energy_factor",
        ],
        "kind": "mul",
    },
    "conformer_block_02_self_att_ln_Q_H_": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_02_self_att_ln_Q",
    },
    "conformer_block_02_self_att_ln_V": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_02_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_02_self_att_ln_V_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_02_self_att_ln_V_concat",
    },
    "conformer_block_02_self_att_ln_V__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_02_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_02_self_att_ln_V__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_02_self_att_ln_V__chunk_shifted",
    },
    "conformer_block_02_self_att_ln_V__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_02_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_02_self_att_ln_V__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_02_self_att_ln_V__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_02_self_att_ln_V__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_02_self_att_ln_V__chunk_shifted_1",
    },
    "conformer_block_02_self_att_ln_V__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_02_self_att_ln_V__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_02_self_att_ln_V__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_02_self_att_ln_V__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_02_self_att_ln_V__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_02_self_att_ln_V__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_02_self_att_ln_V__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_02_self_att_ln_V",
    },
    "conformer_block_02_self_att_ln_V_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_02_self_att_ln_V__chunk_shifted___1_sliced", "T"),
            ("conformer_block_02_self_att_ln_V__chunk_shifted___sliced", "T"),
            ("conformer_block_02_self_att_ln_V", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_02_self_att_ln_att": {
        "class": "reinterpret_data",
        "from": "conformer_block_02_self_att_ln_att_",
        "set_axes": {"T": "dim:35"},
    },
    "conformer_block_02_self_att_ln_att0": {
        "class": "dot",
        "from": [
            "conformer_block_02_self_att_ln_weights_drop",
            "conformer_block_02_self_att_ln_V_H",
        ],
        "reduce": concat_window_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_02_self_att_ln_att_": {
        "axes": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "class": "merge_dims",
        "from": "conformer_block_02_self_att_ln_att0",
    },
    "conformer_block_02_self_att_ln_energy": {
        "class": "dot",
        "from": [
            "conformer_block_02_self_att_ln_K_H",
            "conformer_block_02_self_att_ln_Q_H",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_02_self_att_ln_energy_": {
        "allow_broadcast_all_sources": False,
        "class": "combine",
        "from": [
            "conformer_block_02_self_att_ln_energy",
            "conformer_block_02_self_att_ln_energy_rel_pos",
        ],
        "kind": "add",
    },
    "conformer_block_02_self_att_ln_energy_rel_pos": {
        "class": "dot",
        "from": [
            "conformer_block_02_self_att_ln_Q_H",
            "conformer_block_02_self_att_ln_rel_pos_enc",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_02_self_att_ln_rel_pos_enc": {
        "class": "relative_positional_encoding",
        "clipping": 16,
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_02_self_att_ln_K_concat",
        "key_value_spatial_dim": concat_window_dim,
        "out_dim": enc_dim_per_head_dim,
        "query_offset": 70,
        "query_spatial_dim": chunk_size_dim,
    },
    "conformer_block_02_self_att_ln_weights": {
        "class": "softmax_over_spatial",
        "from": "conformer_block_02_self_att_ln_energy_",
    },
    "conformer_block_02_self_att_ln_weights_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "dropout_noise_shape": {"*": None},
        "from": "conformer_block_02_self_att_ln_weights",
    },
    "conformer_block_02_self_att_res": {
        "class": "combine",
        "from": [
            "conformer_block_02_self_att_dropout",
            "conformer_block_02_ffmod_1_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_03": {"class": "copy", "from": "conformer_block_03_ln"},
    "conformer_block_03_conv_mod_bn": {
        "class": "batch_norm",
        "delay_sample_update": True,
        "epsilon": 0.001,
        "from": "conformer_block_03_conv_mod_depthwise_conv_slice",
        "momentum": 0.1,
        "update_sample_only_in_training": True,
    },
    "conformer_block_03_conv_mod_depthwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "conv",
        "filter_size": (32,),
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_03_conv_mod_glu_act_concat",
        "groups": 512,
        "n_out": 512,
        "padding": "same",
        "with_bias": True,
    },
    "conformer_block_03_conv_mod_depthwise_conv_slice": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_03_conv_mod_depthwise_conv2",
        "slice_start": 40,
    },
    "conformer_block_03_conv_mod_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_03_conv_mod_pointwise_conv2",
    },
    "conformer_block_03_conv_mod_glu": {
        "activation": "identity",
        "class": "gating",
        "from": "conformer_block_03_conv_mod_pointwise_conv1",
    },
    "conformer_block_03_conv_mod_glu_act_chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_03_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_03_conv_mod_glu_act_chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_03_conv_mod_glu_act_chunk_shifted",
    },
    "conformer_block_03_conv_mod_glu_act_chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_03_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_03_conv_mod_glu_act_chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_03_conv_mod_glu_act_chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_03_conv_mod_glu_act_chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_03_conv_mod_glu_act_chunk_shifted_1",
    },
    "conformer_block_03_conv_mod_glu_act_chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_03_conv_mod_glu_act_chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_03_conv_mod_glu_act_chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_03_conv_mod_glu_act_chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_03_conv_mod_glu_act_chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_03_conv_mod_glu_act_chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_03_conv_mod_glu_act_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_03_conv_mod_glu_act_chunk_shifted___1_sliced", "T"),
            ("conformer_block_03_conv_mod_glu_act_chunk_shifted___sliced", "T"),
            ("conformer_block_03_conv_mod_glu", "T"),
        ],
        "out_dim": conv_cache_concat_dim,
    },
    "conformer_block_03_conv_mod_glu_act_split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_03_conv_mod_glu",
    },
    "conformer_block_03_conv_mod_ln": {
        "class": "layer_norm",
        "from": "conformer_block_03_self_att_res",
    },
    "conformer_block_03_conv_mod_pointwise_conv1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_03_conv_mod_ln",
        "n_out": 1024,
        "with_bias": True,
    },
    "conformer_block_03_conv_mod_pointwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_03_conv_mod_swish",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_03_conv_mod_res": {
        "class": "combine",
        "from": ["conformer_block_03_conv_mod_drop", "conformer_block_03_self_att_res"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_03_conv_mod_swish": {
        "activation": "swish",
        "class": "activation",
        "from": "conformer_block_03_conv_mod_bn",
    },
    "conformer_block_03_ffmod_1_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_03_ffmod_1_square_relu",
    },
    "conformer_block_03_ffmod_1_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_03_ffmod_1_ff2",
    },
    "conformer_block_03_ffmod_1_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_03_ffmod_1_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_03_ffmod_1_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_03_ffmod_1_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_03_ffmod_1_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_03_ffmod_1_drop2",
    },
    "conformer_block_03_ffmod_1_ln": {
        "class": "layer_norm",
        "from": "conformer_block_02",
    },
    "conformer_block_03_ffmod_1_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_03_ffmod_1_ff1",
    },
    "conformer_block_03_ffmod_1_res": {
        "class": "combine",
        "from": ["conformer_block_03_ffmod_1_half_step", "conformer_block_02"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_03_ffmod_1_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_03_ffmod_1_relu",
    },
    "conformer_block_03_ffmod_2_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_03_ffmod_2_square_relu",
    },
    "conformer_block_03_ffmod_2_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_03_ffmod_2_ff2",
    },
    "conformer_block_03_ffmod_2_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_03_ffmod_2_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_03_ffmod_2_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_03_ffmod_2_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_03_ffmod_2_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_03_ffmod_2_drop2",
    },
    "conformer_block_03_ffmod_2_ln": {
        "class": "layer_norm",
        "from": "conformer_block_03_conv_mod_res",
    },
    "conformer_block_03_ffmod_2_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_03_ffmod_2_ff1",
    },
    "conformer_block_03_ffmod_2_res": {
        "class": "combine",
        "from": [
            "conformer_block_03_ffmod_2_half_step",
            "conformer_block_03_conv_mod_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_03_ffmod_2_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_03_ffmod_2_relu",
    },
    "conformer_block_03_ln": {
        "class": "layer_norm",
        "from": "conformer_block_03_ffmod_2_res",
    },
    "conformer_block_03_self_att_Q_energy_factor": {
        "class": "eval",
        "eval": "source(0) ** -0.5",
        "from": "conformer_block_03_self_att_dim_per_head_const",
    },
    "conformer_block_03_self_att_dim_per_head_const": {
        "class": "constant",
        "dtype": "float32",
        "value": 64,
    },
    "conformer_block_03_self_att_dropout": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_03_self_att_linear",
    },
    "conformer_block_03_self_att_linear": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_03_self_att_ln_att",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_03_self_att_ln": {
        "class": "layer_norm",
        "from": "conformer_block_03_ffmod_1_res",
    },
    "conformer_block_03_self_att_ln_K": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_03_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_03_self_att_ln_K_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_03_self_att_ln_K_concat",
    },
    "conformer_block_03_self_att_ln_K__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_03_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_03_self_att_ln_K__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_03_self_att_ln_K__chunk_shifted",
    },
    "conformer_block_03_self_att_ln_K__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_03_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_03_self_att_ln_K__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_03_self_att_ln_K__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_03_self_att_ln_K__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_03_self_att_ln_K__chunk_shifted_1",
    },
    "conformer_block_03_self_att_ln_K__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_03_self_att_ln_K__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_03_self_att_ln_K__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_03_self_att_ln_K__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_03_self_att_ln_K__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_03_self_att_ln_K__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_03_self_att_ln_K__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_03_self_att_ln_K",
    },
    "conformer_block_03_self_att_ln_K_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_03_self_att_ln_K__chunk_shifted___1_sliced", "T"),
            ("conformer_block_03_self_att_ln_K__chunk_shifted___sliced", "T"),
            ("conformer_block_03_self_att_ln_K", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_03_self_att_ln_Q": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_03_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_03_self_att_ln_Q_H": {
        "class": "combine",
        "from": [
            "conformer_block_03_self_att_ln_Q_H_",
            "conformer_block_03_self_att_Q_energy_factor",
        ],
        "kind": "mul",
    },
    "conformer_block_03_self_att_ln_Q_H_": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_03_self_att_ln_Q",
    },
    "conformer_block_03_self_att_ln_V": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_03_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_03_self_att_ln_V_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_03_self_att_ln_V_concat",
    },
    "conformer_block_03_self_att_ln_V__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_03_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_03_self_att_ln_V__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_03_self_att_ln_V__chunk_shifted",
    },
    "conformer_block_03_self_att_ln_V__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_03_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_03_self_att_ln_V__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_03_self_att_ln_V__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_03_self_att_ln_V__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_03_self_att_ln_V__chunk_shifted_1",
    },
    "conformer_block_03_self_att_ln_V__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_03_self_att_ln_V__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_03_self_att_ln_V__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_03_self_att_ln_V__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_03_self_att_ln_V__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_03_self_att_ln_V__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_03_self_att_ln_V__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_03_self_att_ln_V",
    },
    "conformer_block_03_self_att_ln_V_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_03_self_att_ln_V__chunk_shifted___1_sliced", "T"),
            ("conformer_block_03_self_att_ln_V__chunk_shifted___sliced", "T"),
            ("conformer_block_03_self_att_ln_V", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_03_self_att_ln_att": {
        "class": "reinterpret_data",
        "from": "conformer_block_03_self_att_ln_att_",
        "set_axes": {"T": "dim:35"},
    },
    "conformer_block_03_self_att_ln_att0": {
        "class": "dot",
        "from": [
            "conformer_block_03_self_att_ln_weights_drop",
            "conformer_block_03_self_att_ln_V_H",
        ],
        "reduce": concat_window_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_03_self_att_ln_att_": {
        "axes": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "class": "merge_dims",
        "from": "conformer_block_03_self_att_ln_att0",
    },
    "conformer_block_03_self_att_ln_energy": {
        "class": "dot",
        "from": [
            "conformer_block_03_self_att_ln_K_H",
            "conformer_block_03_self_att_ln_Q_H",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_03_self_att_ln_energy_": {
        "allow_broadcast_all_sources": False,
        "class": "combine",
        "from": [
            "conformer_block_03_self_att_ln_energy",
            "conformer_block_03_self_att_ln_energy_rel_pos",
        ],
        "kind": "add",
    },
    "conformer_block_03_self_att_ln_energy_rel_pos": {
        "class": "dot",
        "from": [
            "conformer_block_03_self_att_ln_Q_H",
            "conformer_block_03_self_att_ln_rel_pos_enc",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_03_self_att_ln_rel_pos_enc": {
        "class": "relative_positional_encoding",
        "clipping": 16,
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_03_self_att_ln_K_concat",
        "key_value_spatial_dim": concat_window_dim,
        "out_dim": enc_dim_per_head_dim,
        "query_offset": 70,
        "query_spatial_dim": chunk_size_dim,
    },
    "conformer_block_03_self_att_ln_weights": {
        "class": "softmax_over_spatial",
        "from": "conformer_block_03_self_att_ln_energy_",
    },
    "conformer_block_03_self_att_ln_weights_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "dropout_noise_shape": {"*": None},
        "from": "conformer_block_03_self_att_ln_weights",
    },
    "conformer_block_03_self_att_res": {
        "class": "combine",
        "from": [
            "conformer_block_03_self_att_dropout",
            "conformer_block_03_ffmod_1_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_04": {"class": "copy", "from": "conformer_block_04_ln"},
    "conformer_block_04_conv_mod_bn": {
        "class": "batch_norm",
        "delay_sample_update": True,
        "epsilon": 0.001,
        "from": "conformer_block_04_conv_mod_depthwise_conv_slice",
        "momentum": 0.1,
        "update_sample_only_in_training": True,
    },
    "conformer_block_04_conv_mod_depthwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "conv",
        "filter_size": (32,),
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_04_conv_mod_glu_act_concat",
        "groups": 512,
        "n_out": 512,
        "padding": "same",
        "with_bias": True,
    },
    "conformer_block_04_conv_mod_depthwise_conv_slice": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_04_conv_mod_depthwise_conv2",
        "slice_start": 40,
    },
    "conformer_block_04_conv_mod_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_04_conv_mod_pointwise_conv2",
    },
    "conformer_block_04_conv_mod_glu": {
        "activation": "identity",
        "class": "gating",
        "from": "conformer_block_04_conv_mod_pointwise_conv1",
    },
    "conformer_block_04_conv_mod_glu_act_chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_04_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_04_conv_mod_glu_act_chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_04_conv_mod_glu_act_chunk_shifted",
    },
    "conformer_block_04_conv_mod_glu_act_chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_04_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_04_conv_mod_glu_act_chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_04_conv_mod_glu_act_chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_04_conv_mod_glu_act_chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_04_conv_mod_glu_act_chunk_shifted_1",
    },
    "conformer_block_04_conv_mod_glu_act_chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_04_conv_mod_glu_act_chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_04_conv_mod_glu_act_chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_04_conv_mod_glu_act_chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_04_conv_mod_glu_act_chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_04_conv_mod_glu_act_chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_04_conv_mod_glu_act_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_04_conv_mod_glu_act_chunk_shifted___1_sliced", "T"),
            ("conformer_block_04_conv_mod_glu_act_chunk_shifted___sliced", "T"),
            ("conformer_block_04_conv_mod_glu", "T"),
        ],
        "out_dim": conv_cache_concat_dim,
    },
    "conformer_block_04_conv_mod_glu_act_split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_04_conv_mod_glu",
    },
    "conformer_block_04_conv_mod_ln": {
        "class": "layer_norm",
        "from": "conformer_block_04_self_att_res",
    },
    "conformer_block_04_conv_mod_pointwise_conv1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_04_conv_mod_ln",
        "n_out": 1024,
        "with_bias": True,
    },
    "conformer_block_04_conv_mod_pointwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_04_conv_mod_swish",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_04_conv_mod_res": {
        "class": "combine",
        "from": ["conformer_block_04_conv_mod_drop", "conformer_block_04_self_att_res"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_04_conv_mod_swish": {
        "activation": "swish",
        "class": "activation",
        "from": "conformer_block_04_conv_mod_bn",
    },
    "conformer_block_04_ffmod_1_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_04_ffmod_1_square_relu",
    },
    "conformer_block_04_ffmod_1_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_04_ffmod_1_ff2",
    },
    "conformer_block_04_ffmod_1_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_04_ffmod_1_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_04_ffmod_1_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_04_ffmod_1_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_04_ffmod_1_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_04_ffmod_1_drop2",
    },
    "conformer_block_04_ffmod_1_ln": {
        "class": "layer_norm",
        "from": "conformer_block_03",
    },
    "conformer_block_04_ffmod_1_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_04_ffmod_1_ff1",
    },
    "conformer_block_04_ffmod_1_res": {
        "class": "combine",
        "from": ["conformer_block_04_ffmod_1_half_step", "conformer_block_03"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_04_ffmod_1_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_04_ffmod_1_relu",
    },
    "conformer_block_04_ffmod_2_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_04_ffmod_2_square_relu",
    },
    "conformer_block_04_ffmod_2_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_04_ffmod_2_ff2",
    },
    "conformer_block_04_ffmod_2_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_04_ffmod_2_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_04_ffmod_2_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_04_ffmod_2_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_04_ffmod_2_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_04_ffmod_2_drop2",
    },
    "conformer_block_04_ffmod_2_ln": {
        "class": "layer_norm",
        "from": "conformer_block_04_conv_mod_res",
    },
    "conformer_block_04_ffmod_2_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_04_ffmod_2_ff1",
    },
    "conformer_block_04_ffmod_2_res": {
        "class": "combine",
        "from": [
            "conformer_block_04_ffmod_2_half_step",
            "conformer_block_04_conv_mod_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_04_ffmod_2_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_04_ffmod_2_relu",
    },
    "conformer_block_04_ln": {
        "class": "layer_norm",
        "from": "conformer_block_04_ffmod_2_res",
    },
    "conformer_block_04_self_att_Q_energy_factor": {
        "class": "eval",
        "eval": "source(0) ** -0.5",
        "from": "conformer_block_04_self_att_dim_per_head_const",
    },
    "conformer_block_04_self_att_dim_per_head_const": {
        "class": "constant",
        "dtype": "float32",
        "value": 64,
    },
    "conformer_block_04_self_att_dropout": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_04_self_att_linear",
    },
    "conformer_block_04_self_att_linear": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_04_self_att_ln_att",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_04_self_att_ln": {
        "class": "layer_norm",
        "from": "conformer_block_04_ffmod_1_res",
    },
    "conformer_block_04_self_att_ln_K": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_04_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_04_self_att_ln_K_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_04_self_att_ln_K_concat",
    },
    "conformer_block_04_self_att_ln_K__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_04_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_04_self_att_ln_K__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_04_self_att_ln_K__chunk_shifted",
    },
    "conformer_block_04_self_att_ln_K__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_04_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_04_self_att_ln_K__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_04_self_att_ln_K__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_04_self_att_ln_K__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_04_self_att_ln_K__chunk_shifted_1",
    },
    "conformer_block_04_self_att_ln_K__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_04_self_att_ln_K__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_04_self_att_ln_K__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_04_self_att_ln_K__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_04_self_att_ln_K__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_04_self_att_ln_K__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_04_self_att_ln_K__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_04_self_att_ln_K",
    },
    "conformer_block_04_self_att_ln_K_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_04_self_att_ln_K__chunk_shifted___1_sliced", "T"),
            ("conformer_block_04_self_att_ln_K__chunk_shifted___sliced", "T"),
            ("conformer_block_04_self_att_ln_K", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_04_self_att_ln_Q": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_04_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_04_self_att_ln_Q_H": {
        "class": "combine",
        "from": [
            "conformer_block_04_self_att_ln_Q_H_",
            "conformer_block_04_self_att_Q_energy_factor",
        ],
        "kind": "mul",
    },
    "conformer_block_04_self_att_ln_Q_H_": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_04_self_att_ln_Q",
    },
    "conformer_block_04_self_att_ln_V": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_04_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_04_self_att_ln_V_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_04_self_att_ln_V_concat",
    },
    "conformer_block_04_self_att_ln_V__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_04_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_04_self_att_ln_V__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_04_self_att_ln_V__chunk_shifted",
    },
    "conformer_block_04_self_att_ln_V__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_04_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_04_self_att_ln_V__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_04_self_att_ln_V__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_04_self_att_ln_V__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_04_self_att_ln_V__chunk_shifted_1",
    },
    "conformer_block_04_self_att_ln_V__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_04_self_att_ln_V__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_04_self_att_ln_V__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_04_self_att_ln_V__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_04_self_att_ln_V__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_04_self_att_ln_V__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_04_self_att_ln_V__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_04_self_att_ln_V",
    },
    "conformer_block_04_self_att_ln_V_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_04_self_att_ln_V__chunk_shifted___1_sliced", "T"),
            ("conformer_block_04_self_att_ln_V__chunk_shifted___sliced", "T"),
            ("conformer_block_04_self_att_ln_V", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_04_self_att_ln_att": {
        "class": "reinterpret_data",
        "from": "conformer_block_04_self_att_ln_att_",
        "set_axes": {"T": "dim:35"},
    },
    "conformer_block_04_self_att_ln_att0": {
        "class": "dot",
        "from": [
            "conformer_block_04_self_att_ln_weights_drop",
            "conformer_block_04_self_att_ln_V_H",
        ],
        "reduce": concat_window_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_04_self_att_ln_att_": {
        "axes": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "class": "merge_dims",
        "from": "conformer_block_04_self_att_ln_att0",
    },
    "conformer_block_04_self_att_ln_energy": {
        "class": "dot",
        "from": [
            "conformer_block_04_self_att_ln_K_H",
            "conformer_block_04_self_att_ln_Q_H",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_04_self_att_ln_energy_": {
        "allow_broadcast_all_sources": False,
        "class": "combine",
        "from": [
            "conformer_block_04_self_att_ln_energy",
            "conformer_block_04_self_att_ln_energy_rel_pos",
        ],
        "kind": "add",
    },
    "conformer_block_04_self_att_ln_energy_rel_pos": {
        "class": "dot",
        "from": [
            "conformer_block_04_self_att_ln_Q_H",
            "conformer_block_04_self_att_ln_rel_pos_enc",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_04_self_att_ln_rel_pos_enc": {
        "class": "relative_positional_encoding",
        "clipping": 16,
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_04_self_att_ln_K_concat",
        "key_value_spatial_dim": concat_window_dim,
        "out_dim": enc_dim_per_head_dim,
        "query_offset": 70,
        "query_spatial_dim": chunk_size_dim,
    },
    "conformer_block_04_self_att_ln_weights": {
        "class": "softmax_over_spatial",
        "from": "conformer_block_04_self_att_ln_energy_",
    },
    "conformer_block_04_self_att_ln_weights_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "dropout_noise_shape": {"*": None},
        "from": "conformer_block_04_self_att_ln_weights",
    },
    "conformer_block_04_self_att_res": {
        "class": "combine",
        "from": [
            "conformer_block_04_self_att_dropout",
            "conformer_block_04_ffmod_1_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_05": {"class": "copy", "from": "conformer_block_05_ln"},
    "conformer_block_05_conv_mod_bn": {
        "class": "batch_norm",
        "delay_sample_update": True,
        "epsilon": 0.001,
        "from": "conformer_block_05_conv_mod_depthwise_conv_slice",
        "momentum": 0.1,
        "update_sample_only_in_training": True,
    },
    "conformer_block_05_conv_mod_depthwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "conv",
        "filter_size": (32,),
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_05_conv_mod_glu_act_concat",
        "groups": 512,
        "n_out": 512,
        "padding": "same",
        "with_bias": True,
    },
    "conformer_block_05_conv_mod_depthwise_conv_slice": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_05_conv_mod_depthwise_conv2",
        "slice_start": 40,
    },
    "conformer_block_05_conv_mod_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_05_conv_mod_pointwise_conv2",
    },
    "conformer_block_05_conv_mod_glu": {
        "activation": "identity",
        "class": "gating",
        "from": "conformer_block_05_conv_mod_pointwise_conv1",
    },
    "conformer_block_05_conv_mod_glu_act_chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_05_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_05_conv_mod_glu_act_chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_05_conv_mod_glu_act_chunk_shifted",
    },
    "conformer_block_05_conv_mod_glu_act_chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_05_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_05_conv_mod_glu_act_chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_05_conv_mod_glu_act_chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_05_conv_mod_glu_act_chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_05_conv_mod_glu_act_chunk_shifted_1",
    },
    "conformer_block_05_conv_mod_glu_act_chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_05_conv_mod_glu_act_chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_05_conv_mod_glu_act_chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_05_conv_mod_glu_act_chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_05_conv_mod_glu_act_chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_05_conv_mod_glu_act_chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_05_conv_mod_glu_act_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_05_conv_mod_glu_act_chunk_shifted___1_sliced", "T"),
            ("conformer_block_05_conv_mod_glu_act_chunk_shifted___sliced", "T"),
            ("conformer_block_05_conv_mod_glu", "T"),
        ],
        "out_dim": conv_cache_concat_dim,
    },
    "conformer_block_05_conv_mod_glu_act_split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_05_conv_mod_glu",
    },
    "conformer_block_05_conv_mod_ln": {
        "class": "layer_norm",
        "from": "conformer_block_05_self_att_res",
    },
    "conformer_block_05_conv_mod_pointwise_conv1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_05_conv_mod_ln",
        "n_out": 1024,
        "with_bias": True,
    },
    "conformer_block_05_conv_mod_pointwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_05_conv_mod_swish",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_05_conv_mod_res": {
        "class": "combine",
        "from": ["conformer_block_05_conv_mod_drop", "conformer_block_05_self_att_res"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_05_conv_mod_swish": {
        "activation": "swish",
        "class": "activation",
        "from": "conformer_block_05_conv_mod_bn",
    },
    "conformer_block_05_ffmod_1_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_05_ffmod_1_square_relu",
    },
    "conformer_block_05_ffmod_1_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_05_ffmod_1_ff2",
    },
    "conformer_block_05_ffmod_1_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_05_ffmod_1_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_05_ffmod_1_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_05_ffmod_1_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_05_ffmod_1_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_05_ffmod_1_drop2",
    },
    "conformer_block_05_ffmod_1_ln": {
        "class": "layer_norm",
        "from": "conformer_block_04",
    },
    "conformer_block_05_ffmod_1_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_05_ffmod_1_ff1",
    },
    "conformer_block_05_ffmod_1_res": {
        "class": "combine",
        "from": ["conformer_block_05_ffmod_1_half_step", "conformer_block_04"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_05_ffmod_1_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_05_ffmod_1_relu",
    },
    "conformer_block_05_ffmod_2_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_05_ffmod_2_square_relu",
    },
    "conformer_block_05_ffmod_2_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_05_ffmod_2_ff2",
    },
    "conformer_block_05_ffmod_2_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_05_ffmod_2_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_05_ffmod_2_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_05_ffmod_2_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_05_ffmod_2_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_05_ffmod_2_drop2",
    },
    "conformer_block_05_ffmod_2_ln": {
        "class": "layer_norm",
        "from": "conformer_block_05_conv_mod_res",
    },
    "conformer_block_05_ffmod_2_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_05_ffmod_2_ff1",
    },
    "conformer_block_05_ffmod_2_res": {
        "class": "combine",
        "from": [
            "conformer_block_05_ffmod_2_half_step",
            "conformer_block_05_conv_mod_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_05_ffmod_2_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_05_ffmod_2_relu",
    },
    "conformer_block_05_ln": {
        "class": "layer_norm",
        "from": "conformer_block_05_ffmod_2_res",
    },
    "conformer_block_05_self_att_Q_energy_factor": {
        "class": "eval",
        "eval": "source(0) ** -0.5",
        "from": "conformer_block_05_self_att_dim_per_head_const",
    },
    "conformer_block_05_self_att_dim_per_head_const": {
        "class": "constant",
        "dtype": "float32",
        "value": 64,
    },
    "conformer_block_05_self_att_dropout": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_05_self_att_linear",
    },
    "conformer_block_05_self_att_linear": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_05_self_att_ln_att",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_05_self_att_ln": {
        "class": "layer_norm",
        "from": "conformer_block_05_ffmod_1_res",
    },
    "conformer_block_05_self_att_ln_K": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_05_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_05_self_att_ln_K_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_05_self_att_ln_K_concat",
    },
    "conformer_block_05_self_att_ln_K__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_05_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_05_self_att_ln_K__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_05_self_att_ln_K__chunk_shifted",
    },
    "conformer_block_05_self_att_ln_K__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_05_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_05_self_att_ln_K__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_05_self_att_ln_K__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_05_self_att_ln_K__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_05_self_att_ln_K__chunk_shifted_1",
    },
    "conformer_block_05_self_att_ln_K__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_05_self_att_ln_K__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_05_self_att_ln_K__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_05_self_att_ln_K__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_05_self_att_ln_K__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_05_self_att_ln_K__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_05_self_att_ln_K__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_05_self_att_ln_K",
    },
    "conformer_block_05_self_att_ln_K_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_05_self_att_ln_K__chunk_shifted___1_sliced", "T"),
            ("conformer_block_05_self_att_ln_K__chunk_shifted___sliced", "T"),
            ("conformer_block_05_self_att_ln_K", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_05_self_att_ln_Q": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_05_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_05_self_att_ln_Q_H": {
        "class": "combine",
        "from": [
            "conformer_block_05_self_att_ln_Q_H_",
            "conformer_block_05_self_att_Q_energy_factor",
        ],
        "kind": "mul",
    },
    "conformer_block_05_self_att_ln_Q_H_": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_05_self_att_ln_Q",
    },
    "conformer_block_05_self_att_ln_V": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_05_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_05_self_att_ln_V_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_05_self_att_ln_V_concat",
    },
    "conformer_block_05_self_att_ln_V__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_05_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_05_self_att_ln_V__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_05_self_att_ln_V__chunk_shifted",
    },
    "conformer_block_05_self_att_ln_V__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_05_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_05_self_att_ln_V__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_05_self_att_ln_V__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_05_self_att_ln_V__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_05_self_att_ln_V__chunk_shifted_1",
    },
    "conformer_block_05_self_att_ln_V__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_05_self_att_ln_V__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_05_self_att_ln_V__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_05_self_att_ln_V__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_05_self_att_ln_V__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_05_self_att_ln_V__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_05_self_att_ln_V__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_05_self_att_ln_V",
    },
    "conformer_block_05_self_att_ln_V_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_05_self_att_ln_V__chunk_shifted___1_sliced", "T"),
            ("conformer_block_05_self_att_ln_V__chunk_shifted___sliced", "T"),
            ("conformer_block_05_self_att_ln_V", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_05_self_att_ln_att": {
        "class": "reinterpret_data",
        "from": "conformer_block_05_self_att_ln_att_",
        "set_axes": {"T": "dim:35"},
    },
    "conformer_block_05_self_att_ln_att0": {
        "class": "dot",
        "from": [
            "conformer_block_05_self_att_ln_weights_drop",
            "conformer_block_05_self_att_ln_V_H",
        ],
        "reduce": concat_window_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_05_self_att_ln_att_": {
        "axes": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "class": "merge_dims",
        "from": "conformer_block_05_self_att_ln_att0",
    },
    "conformer_block_05_self_att_ln_energy": {
        "class": "dot",
        "from": [
            "conformer_block_05_self_att_ln_K_H",
            "conformer_block_05_self_att_ln_Q_H",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_05_self_att_ln_energy_": {
        "allow_broadcast_all_sources": False,
        "class": "combine",
        "from": [
            "conformer_block_05_self_att_ln_energy",
            "conformer_block_05_self_att_ln_energy_rel_pos",
        ],
        "kind": "add",
    },
    "conformer_block_05_self_att_ln_energy_rel_pos": {
        "class": "dot",
        "from": [
            "conformer_block_05_self_att_ln_Q_H",
            "conformer_block_05_self_att_ln_rel_pos_enc",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_05_self_att_ln_rel_pos_enc": {
        "class": "relative_positional_encoding",
        "clipping": 16,
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_05_self_att_ln_K_concat",
        "key_value_spatial_dim": concat_window_dim,
        "out_dim": enc_dim_per_head_dim,
        "query_offset": 70,
        "query_spatial_dim": chunk_size_dim,
    },
    "conformer_block_05_self_att_ln_weights": {
        "class": "softmax_over_spatial",
        "from": "conformer_block_05_self_att_ln_energy_",
    },
    "conformer_block_05_self_att_ln_weights_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "dropout_noise_shape": {"*": None},
        "from": "conformer_block_05_self_att_ln_weights",
    },
    "conformer_block_05_self_att_res": {
        "class": "combine",
        "from": [
            "conformer_block_05_self_att_dropout",
            "conformer_block_05_ffmod_1_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_06": {"class": "copy", "from": "conformer_block_06_ln"},
    "conformer_block_06_conv_mod_bn": {
        "class": "batch_norm",
        "delay_sample_update": True,
        "epsilon": 0.001,
        "from": "conformer_block_06_conv_mod_depthwise_conv_slice",
        "momentum": 0.1,
        "update_sample_only_in_training": True,
    },
    "conformer_block_06_conv_mod_depthwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "conv",
        "filter_size": (32,),
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_06_conv_mod_glu_act_concat",
        "groups": 512,
        "n_out": 512,
        "padding": "same",
        "with_bias": True,
    },
    "conformer_block_06_conv_mod_depthwise_conv_slice": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_06_conv_mod_depthwise_conv2",
        "slice_start": 40,
    },
    "conformer_block_06_conv_mod_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_06_conv_mod_pointwise_conv2",
    },
    "conformer_block_06_conv_mod_glu": {
        "activation": "identity",
        "class": "gating",
        "from": "conformer_block_06_conv_mod_pointwise_conv1",
    },
    "conformer_block_06_conv_mod_glu_act_chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_06_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_06_conv_mod_glu_act_chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_06_conv_mod_glu_act_chunk_shifted",
    },
    "conformer_block_06_conv_mod_glu_act_chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_06_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_06_conv_mod_glu_act_chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_06_conv_mod_glu_act_chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_06_conv_mod_glu_act_chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_06_conv_mod_glu_act_chunk_shifted_1",
    },
    "conformer_block_06_conv_mod_glu_act_chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_06_conv_mod_glu_act_chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_06_conv_mod_glu_act_chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_06_conv_mod_glu_act_chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_06_conv_mod_glu_act_chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_06_conv_mod_glu_act_chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_06_conv_mod_glu_act_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_06_conv_mod_glu_act_chunk_shifted___1_sliced", "T"),
            ("conformer_block_06_conv_mod_glu_act_chunk_shifted___sliced", "T"),
            ("conformer_block_06_conv_mod_glu", "T"),
        ],
        "out_dim": conv_cache_concat_dim,
    },
    "conformer_block_06_conv_mod_glu_act_split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_06_conv_mod_glu",
    },
    "conformer_block_06_conv_mod_ln": {
        "class": "layer_norm",
        "from": "conformer_block_06_self_att_res",
    },
    "conformer_block_06_conv_mod_pointwise_conv1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_06_conv_mod_ln",
        "n_out": 1024,
        "with_bias": True,
    },
    "conformer_block_06_conv_mod_pointwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_06_conv_mod_swish",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_06_conv_mod_res": {
        "class": "combine",
        "from": ["conformer_block_06_conv_mod_drop", "conformer_block_06_self_att_res"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_06_conv_mod_swish": {
        "activation": "swish",
        "class": "activation",
        "from": "conformer_block_06_conv_mod_bn",
    },
    "conformer_block_06_ffmod_1_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_06_ffmod_1_square_relu",
    },
    "conformer_block_06_ffmod_1_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_06_ffmod_1_ff2",
    },
    "conformer_block_06_ffmod_1_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_06_ffmod_1_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_06_ffmod_1_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_06_ffmod_1_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_06_ffmod_1_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_06_ffmod_1_drop2",
    },
    "conformer_block_06_ffmod_1_ln": {
        "class": "layer_norm",
        "from": "conformer_block_05",
    },
    "conformer_block_06_ffmod_1_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_06_ffmod_1_ff1",
    },
    "conformer_block_06_ffmod_1_res": {
        "class": "combine",
        "from": ["conformer_block_06_ffmod_1_half_step", "conformer_block_05"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_06_ffmod_1_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_06_ffmod_1_relu",
    },
    "conformer_block_06_ffmod_2_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_06_ffmod_2_square_relu",
    },
    "conformer_block_06_ffmod_2_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_06_ffmod_2_ff2",
    },
    "conformer_block_06_ffmod_2_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_06_ffmod_2_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_06_ffmod_2_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_06_ffmod_2_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_06_ffmod_2_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_06_ffmod_2_drop2",
    },
    "conformer_block_06_ffmod_2_ln": {
        "class": "layer_norm",
        "from": "conformer_block_06_conv_mod_res",
    },
    "conformer_block_06_ffmod_2_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_06_ffmod_2_ff1",
    },
    "conformer_block_06_ffmod_2_res": {
        "class": "combine",
        "from": [
            "conformer_block_06_ffmod_2_half_step",
            "conformer_block_06_conv_mod_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_06_ffmod_2_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_06_ffmod_2_relu",
    },
    "conformer_block_06_ln": {
        "class": "layer_norm",
        "from": "conformer_block_06_ffmod_2_res",
    },
    "conformer_block_06_self_att_Q_energy_factor": {
        "class": "eval",
        "eval": "source(0) ** -0.5",
        "from": "conformer_block_06_self_att_dim_per_head_const",
    },
    "conformer_block_06_self_att_dim_per_head_const": {
        "class": "constant",
        "dtype": "float32",
        "value": 64,
    },
    "conformer_block_06_self_att_dropout": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_06_self_att_linear",
    },
    "conformer_block_06_self_att_linear": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_06_self_att_ln_att",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_06_self_att_ln": {
        "class": "layer_norm",
        "from": "conformer_block_06_ffmod_1_res",
    },
    "conformer_block_06_self_att_ln_K": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_06_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_06_self_att_ln_K_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_06_self_att_ln_K_concat",
    },
    "conformer_block_06_self_att_ln_K__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_06_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_06_self_att_ln_K__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_06_self_att_ln_K__chunk_shifted",
    },
    "conformer_block_06_self_att_ln_K__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_06_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_06_self_att_ln_K__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_06_self_att_ln_K__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_06_self_att_ln_K__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_06_self_att_ln_K__chunk_shifted_1",
    },
    "conformer_block_06_self_att_ln_K__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_06_self_att_ln_K__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_06_self_att_ln_K__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_06_self_att_ln_K__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_06_self_att_ln_K__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_06_self_att_ln_K__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_06_self_att_ln_K__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_06_self_att_ln_K",
    },
    "conformer_block_06_self_att_ln_K_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_06_self_att_ln_K__chunk_shifted___1_sliced", "T"),
            ("conformer_block_06_self_att_ln_K__chunk_shifted___sliced", "T"),
            ("conformer_block_06_self_att_ln_K", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_06_self_att_ln_Q": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_06_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_06_self_att_ln_Q_H": {
        "class": "combine",
        "from": [
            "conformer_block_06_self_att_ln_Q_H_",
            "conformer_block_06_self_att_Q_energy_factor",
        ],
        "kind": "mul",
    },
    "conformer_block_06_self_att_ln_Q_H_": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_06_self_att_ln_Q",
    },
    "conformer_block_06_self_att_ln_V": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_06_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_06_self_att_ln_V_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_06_self_att_ln_V_concat",
    },
    "conformer_block_06_self_att_ln_V__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_06_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_06_self_att_ln_V__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_06_self_att_ln_V__chunk_shifted",
    },
    "conformer_block_06_self_att_ln_V__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_06_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_06_self_att_ln_V__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_06_self_att_ln_V__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_06_self_att_ln_V__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_06_self_att_ln_V__chunk_shifted_1",
    },
    "conformer_block_06_self_att_ln_V__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_06_self_att_ln_V__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_06_self_att_ln_V__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_06_self_att_ln_V__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_06_self_att_ln_V__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_06_self_att_ln_V__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_06_self_att_ln_V__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_06_self_att_ln_V",
    },
    "conformer_block_06_self_att_ln_V_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_06_self_att_ln_V__chunk_shifted___1_sliced", "T"),
            ("conformer_block_06_self_att_ln_V__chunk_shifted___sliced", "T"),
            ("conformer_block_06_self_att_ln_V", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_06_self_att_ln_att": {
        "class": "reinterpret_data",
        "from": "conformer_block_06_self_att_ln_att_",
        "set_axes": {"T": "dim:35"},
    },
    "conformer_block_06_self_att_ln_att0": {
        "class": "dot",
        "from": [
            "conformer_block_06_self_att_ln_weights_drop",
            "conformer_block_06_self_att_ln_V_H",
        ],
        "reduce": concat_window_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_06_self_att_ln_att_": {
        "axes": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "class": "merge_dims",
        "from": "conformer_block_06_self_att_ln_att0",
    },
    "conformer_block_06_self_att_ln_energy": {
        "class": "dot",
        "from": [
            "conformer_block_06_self_att_ln_K_H",
            "conformer_block_06_self_att_ln_Q_H",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_06_self_att_ln_energy_": {
        "allow_broadcast_all_sources": False,
        "class": "combine",
        "from": [
            "conformer_block_06_self_att_ln_energy",
            "conformer_block_06_self_att_ln_energy_rel_pos",
        ],
        "kind": "add",
    },
    "conformer_block_06_self_att_ln_energy_rel_pos": {
        "class": "dot",
        "from": [
            "conformer_block_06_self_att_ln_Q_H",
            "conformer_block_06_self_att_ln_rel_pos_enc",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_06_self_att_ln_rel_pos_enc": {
        "class": "relative_positional_encoding",
        "clipping": 16,
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_06_self_att_ln_K_concat",
        "key_value_spatial_dim": concat_window_dim,
        "out_dim": enc_dim_per_head_dim,
        "query_offset": 70,
        "query_spatial_dim": chunk_size_dim,
    },
    "conformer_block_06_self_att_ln_weights": {
        "class": "softmax_over_spatial",
        "from": "conformer_block_06_self_att_ln_energy_",
    },
    "conformer_block_06_self_att_ln_weights_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "dropout_noise_shape": {"*": None},
        "from": "conformer_block_06_self_att_ln_weights",
    },
    "conformer_block_06_self_att_res": {
        "class": "combine",
        "from": [
            "conformer_block_06_self_att_dropout",
            "conformer_block_06_ffmod_1_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_07": {"class": "copy", "from": "conformer_block_07_ln"},
    "conformer_block_07_conv_mod_bn": {
        "class": "batch_norm",
        "delay_sample_update": True,
        "epsilon": 0.001,
        "from": "conformer_block_07_conv_mod_depthwise_conv_slice",
        "momentum": 0.1,
        "update_sample_only_in_training": True,
    },
    "conformer_block_07_conv_mod_depthwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "conv",
        "filter_size": (32,),
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_07_conv_mod_glu_act_concat",
        "groups": 512,
        "n_out": 512,
        "padding": "same",
        "with_bias": True,
    },
    "conformer_block_07_conv_mod_depthwise_conv_slice": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_07_conv_mod_depthwise_conv2",
        "slice_start": 40,
    },
    "conformer_block_07_conv_mod_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_07_conv_mod_pointwise_conv2",
    },
    "conformer_block_07_conv_mod_glu": {
        "activation": "identity",
        "class": "gating",
        "from": "conformer_block_07_conv_mod_pointwise_conv1",
    },
    "conformer_block_07_conv_mod_glu_act_chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_07_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_07_conv_mod_glu_act_chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_07_conv_mod_glu_act_chunk_shifted",
    },
    "conformer_block_07_conv_mod_glu_act_chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_07_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_07_conv_mod_glu_act_chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_07_conv_mod_glu_act_chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_07_conv_mod_glu_act_chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_07_conv_mod_glu_act_chunk_shifted_1",
    },
    "conformer_block_07_conv_mod_glu_act_chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_07_conv_mod_glu_act_chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_07_conv_mod_glu_act_chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_07_conv_mod_glu_act_chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_07_conv_mod_glu_act_chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_07_conv_mod_glu_act_chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_07_conv_mod_glu_act_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_07_conv_mod_glu_act_chunk_shifted___1_sliced", "T"),
            ("conformer_block_07_conv_mod_glu_act_chunk_shifted___sliced", "T"),
            ("conformer_block_07_conv_mod_glu", "T"),
        ],
        "out_dim": conv_cache_concat_dim,
    },
    "conformer_block_07_conv_mod_glu_act_split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_07_conv_mod_glu",
    },
    "conformer_block_07_conv_mod_ln": {
        "class": "layer_norm",
        "from": "conformer_block_07_self_att_res",
    },
    "conformer_block_07_conv_mod_pointwise_conv1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_07_conv_mod_ln",
        "n_out": 1024,
        "with_bias": True,
    },
    "conformer_block_07_conv_mod_pointwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_07_conv_mod_swish",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_07_conv_mod_res": {
        "class": "combine",
        "from": ["conformer_block_07_conv_mod_drop", "conformer_block_07_self_att_res"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_07_conv_mod_swish": {
        "activation": "swish",
        "class": "activation",
        "from": "conformer_block_07_conv_mod_bn",
    },
    "conformer_block_07_ffmod_1_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_07_ffmod_1_square_relu",
    },
    "conformer_block_07_ffmod_1_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_07_ffmod_1_ff2",
    },
    "conformer_block_07_ffmod_1_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_07_ffmod_1_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_07_ffmod_1_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_07_ffmod_1_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_07_ffmod_1_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_07_ffmod_1_drop2",
    },
    "conformer_block_07_ffmod_1_ln": {
        "class": "layer_norm",
        "from": "conformer_block_06",
    },
    "conformer_block_07_ffmod_1_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_07_ffmod_1_ff1",
    },
    "conformer_block_07_ffmod_1_res": {
        "class": "combine",
        "from": ["conformer_block_07_ffmod_1_half_step", "conformer_block_06"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_07_ffmod_1_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_07_ffmod_1_relu",
    },
    "conformer_block_07_ffmod_2_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_07_ffmod_2_square_relu",
    },
    "conformer_block_07_ffmod_2_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_07_ffmod_2_ff2",
    },
    "conformer_block_07_ffmod_2_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_07_ffmod_2_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_07_ffmod_2_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_07_ffmod_2_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_07_ffmod_2_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_07_ffmod_2_drop2",
    },
    "conformer_block_07_ffmod_2_ln": {
        "class": "layer_norm",
        "from": "conformer_block_07_conv_mod_res",
    },
    "conformer_block_07_ffmod_2_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_07_ffmod_2_ff1",
    },
    "conformer_block_07_ffmod_2_res": {
        "class": "combine",
        "from": [
            "conformer_block_07_ffmod_2_half_step",
            "conformer_block_07_conv_mod_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_07_ffmod_2_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_07_ffmod_2_relu",
    },
    "conformer_block_07_ln": {
        "class": "layer_norm",
        "from": "conformer_block_07_ffmod_2_res",
    },
    "conformer_block_07_self_att_Q_energy_factor": {
        "class": "eval",
        "eval": "source(0) ** -0.5",
        "from": "conformer_block_07_self_att_dim_per_head_const",
    },
    "conformer_block_07_self_att_dim_per_head_const": {
        "class": "constant",
        "dtype": "float32",
        "value": 64,
    },
    "conformer_block_07_self_att_dropout": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_07_self_att_linear",
    },
    "conformer_block_07_self_att_linear": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_07_self_att_ln_att",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_07_self_att_ln": {
        "class": "layer_norm",
        "from": "conformer_block_07_ffmod_1_res",
    },
    "conformer_block_07_self_att_ln_K": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_07_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_07_self_att_ln_K_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_07_self_att_ln_K_concat",
    },
    "conformer_block_07_self_att_ln_K__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_07_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_07_self_att_ln_K__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_07_self_att_ln_K__chunk_shifted",
    },
    "conformer_block_07_self_att_ln_K__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_07_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_07_self_att_ln_K__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_07_self_att_ln_K__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_07_self_att_ln_K__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_07_self_att_ln_K__chunk_shifted_1",
    },
    "conformer_block_07_self_att_ln_K__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_07_self_att_ln_K__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_07_self_att_ln_K__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_07_self_att_ln_K__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_07_self_att_ln_K__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_07_self_att_ln_K__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_07_self_att_ln_K__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_07_self_att_ln_K",
    },
    "conformer_block_07_self_att_ln_K_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_07_self_att_ln_K__chunk_shifted___1_sliced", "T"),
            ("conformer_block_07_self_att_ln_K__chunk_shifted___sliced", "T"),
            ("conformer_block_07_self_att_ln_K", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_07_self_att_ln_Q": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_07_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_07_self_att_ln_Q_H": {
        "class": "combine",
        "from": [
            "conformer_block_07_self_att_ln_Q_H_",
            "conformer_block_07_self_att_Q_energy_factor",
        ],
        "kind": "mul",
    },
    "conformer_block_07_self_att_ln_Q_H_": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_07_self_att_ln_Q",
    },
    "conformer_block_07_self_att_ln_V": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_07_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_07_self_att_ln_V_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_07_self_att_ln_V_concat",
    },
    "conformer_block_07_self_att_ln_V__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_07_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_07_self_att_ln_V__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_07_self_att_ln_V__chunk_shifted",
    },
    "conformer_block_07_self_att_ln_V__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_07_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_07_self_att_ln_V__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_07_self_att_ln_V__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_07_self_att_ln_V__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_07_self_att_ln_V__chunk_shifted_1",
    },
    "conformer_block_07_self_att_ln_V__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_07_self_att_ln_V__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_07_self_att_ln_V__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_07_self_att_ln_V__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_07_self_att_ln_V__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_07_self_att_ln_V__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_07_self_att_ln_V__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_07_self_att_ln_V",
    },
    "conformer_block_07_self_att_ln_V_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_07_self_att_ln_V__chunk_shifted___1_sliced", "T"),
            ("conformer_block_07_self_att_ln_V__chunk_shifted___sliced", "T"),
            ("conformer_block_07_self_att_ln_V", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_07_self_att_ln_att": {
        "class": "reinterpret_data",
        "from": "conformer_block_07_self_att_ln_att_",
        "set_axes": {"T": "dim:35"},
    },
    "conformer_block_07_self_att_ln_att0": {
        "class": "dot",
        "from": [
            "conformer_block_07_self_att_ln_weights_drop",
            "conformer_block_07_self_att_ln_V_H",
        ],
        "reduce": concat_window_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_07_self_att_ln_att_": {
        "axes": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "class": "merge_dims",
        "from": "conformer_block_07_self_att_ln_att0",
    },
    "conformer_block_07_self_att_ln_energy": {
        "class": "dot",
        "from": [
            "conformer_block_07_self_att_ln_K_H",
            "conformer_block_07_self_att_ln_Q_H",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_07_self_att_ln_energy_": {
        "allow_broadcast_all_sources": False,
        "class": "combine",
        "from": [
            "conformer_block_07_self_att_ln_energy",
            "conformer_block_07_self_att_ln_energy_rel_pos",
        ],
        "kind": "add",
    },
    "conformer_block_07_self_att_ln_energy_rel_pos": {
        "class": "dot",
        "from": [
            "conformer_block_07_self_att_ln_Q_H",
            "conformer_block_07_self_att_ln_rel_pos_enc",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_07_self_att_ln_rel_pos_enc": {
        "class": "relative_positional_encoding",
        "clipping": 16,
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_07_self_att_ln_K_concat",
        "key_value_spatial_dim": concat_window_dim,
        "out_dim": enc_dim_per_head_dim,
        "query_offset": 70,
        "query_spatial_dim": chunk_size_dim,
    },
    "conformer_block_07_self_att_ln_weights": {
        "class": "softmax_over_spatial",
        "from": "conformer_block_07_self_att_ln_energy_",
    },
    "conformer_block_07_self_att_ln_weights_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "dropout_noise_shape": {"*": None},
        "from": "conformer_block_07_self_att_ln_weights",
    },
    "conformer_block_07_self_att_res": {
        "class": "combine",
        "from": [
            "conformer_block_07_self_att_dropout",
            "conformer_block_07_ffmod_1_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_08": {"class": "copy", "from": "conformer_block_08_ln"},
    "conformer_block_08_conv_mod_bn": {
        "class": "batch_norm",
        "delay_sample_update": True,
        "epsilon": 0.001,
        "from": "conformer_block_08_conv_mod_depthwise_conv_slice",
        "momentum": 0.1,
        "update_sample_only_in_training": True,
    },
    "conformer_block_08_conv_mod_depthwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "conv",
        "filter_size": (32,),
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_08_conv_mod_glu_act_concat",
        "groups": 512,
        "n_out": 512,
        "padding": "same",
        "with_bias": True,
    },
    "conformer_block_08_conv_mod_depthwise_conv_slice": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_08_conv_mod_depthwise_conv2",
        "slice_start": 40,
    },
    "conformer_block_08_conv_mod_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_08_conv_mod_pointwise_conv2",
    },
    "conformer_block_08_conv_mod_glu": {
        "activation": "identity",
        "class": "gating",
        "from": "conformer_block_08_conv_mod_pointwise_conv1",
    },
    "conformer_block_08_conv_mod_glu_act_chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_08_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_08_conv_mod_glu_act_chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_08_conv_mod_glu_act_chunk_shifted",
    },
    "conformer_block_08_conv_mod_glu_act_chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_08_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_08_conv_mod_glu_act_chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_08_conv_mod_glu_act_chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_08_conv_mod_glu_act_chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_08_conv_mod_glu_act_chunk_shifted_1",
    },
    "conformer_block_08_conv_mod_glu_act_chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_08_conv_mod_glu_act_chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_08_conv_mod_glu_act_chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_08_conv_mod_glu_act_chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_08_conv_mod_glu_act_chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_08_conv_mod_glu_act_chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_08_conv_mod_glu_act_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_08_conv_mod_glu_act_chunk_shifted___1_sliced", "T"),
            ("conformer_block_08_conv_mod_glu_act_chunk_shifted___sliced", "T"),
            ("conformer_block_08_conv_mod_glu", "T"),
        ],
        "out_dim": conv_cache_concat_dim,
    },
    "conformer_block_08_conv_mod_glu_act_split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_08_conv_mod_glu",
    },
    "conformer_block_08_conv_mod_ln": {
        "class": "layer_norm",
        "from": "conformer_block_08_self_att_res",
    },
    "conformer_block_08_conv_mod_pointwise_conv1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_08_conv_mod_ln",
        "n_out": 1024,
        "with_bias": True,
    },
    "conformer_block_08_conv_mod_pointwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_08_conv_mod_swish",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_08_conv_mod_res": {
        "class": "combine",
        "from": ["conformer_block_08_conv_mod_drop", "conformer_block_08_self_att_res"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_08_conv_mod_swish": {
        "activation": "swish",
        "class": "activation",
        "from": "conformer_block_08_conv_mod_bn",
    },
    "conformer_block_08_ffmod_1_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_08_ffmod_1_square_relu",
    },
    "conformer_block_08_ffmod_1_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_08_ffmod_1_ff2",
    },
    "conformer_block_08_ffmod_1_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_08_ffmod_1_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_08_ffmod_1_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_08_ffmod_1_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_08_ffmod_1_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_08_ffmod_1_drop2",
    },
    "conformer_block_08_ffmod_1_ln": {
        "class": "layer_norm",
        "from": "conformer_block_07",
    },
    "conformer_block_08_ffmod_1_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_08_ffmod_1_ff1",
    },
    "conformer_block_08_ffmod_1_res": {
        "class": "combine",
        "from": ["conformer_block_08_ffmod_1_half_step", "conformer_block_07"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_08_ffmod_1_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_08_ffmod_1_relu",
    },
    "conformer_block_08_ffmod_2_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_08_ffmod_2_square_relu",
    },
    "conformer_block_08_ffmod_2_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_08_ffmod_2_ff2",
    },
    "conformer_block_08_ffmod_2_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_08_ffmod_2_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_08_ffmod_2_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_08_ffmod_2_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_08_ffmod_2_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_08_ffmod_2_drop2",
    },
    "conformer_block_08_ffmod_2_ln": {
        "class": "layer_norm",
        "from": "conformer_block_08_conv_mod_res",
    },
    "conformer_block_08_ffmod_2_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_08_ffmod_2_ff1",
    },
    "conformer_block_08_ffmod_2_res": {
        "class": "combine",
        "from": [
            "conformer_block_08_ffmod_2_half_step",
            "conformer_block_08_conv_mod_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_08_ffmod_2_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_08_ffmod_2_relu",
    },
    "conformer_block_08_ln": {
        "class": "layer_norm",
        "from": "conformer_block_08_ffmod_2_res",
    },
    "conformer_block_08_self_att_Q_energy_factor": {
        "class": "eval",
        "eval": "source(0) ** -0.5",
        "from": "conformer_block_08_self_att_dim_per_head_const",
    },
    "conformer_block_08_self_att_dim_per_head_const": {
        "class": "constant",
        "dtype": "float32",
        "value": 64,
    },
    "conformer_block_08_self_att_dropout": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_08_self_att_linear",
    },
    "conformer_block_08_self_att_linear": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_08_self_att_ln_att",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_08_self_att_ln": {
        "class": "layer_norm",
        "from": "conformer_block_08_ffmod_1_res",
    },
    "conformer_block_08_self_att_ln_K": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_08_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_08_self_att_ln_K_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_08_self_att_ln_K_concat",
    },
    "conformer_block_08_self_att_ln_K__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_08_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_08_self_att_ln_K__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_08_self_att_ln_K__chunk_shifted",
    },
    "conformer_block_08_self_att_ln_K__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_08_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_08_self_att_ln_K__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_08_self_att_ln_K__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_08_self_att_ln_K__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_08_self_att_ln_K__chunk_shifted_1",
    },
    "conformer_block_08_self_att_ln_K__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_08_self_att_ln_K__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_08_self_att_ln_K__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_08_self_att_ln_K__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_08_self_att_ln_K__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_08_self_att_ln_K__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_08_self_att_ln_K__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_08_self_att_ln_K",
    },
    "conformer_block_08_self_att_ln_K_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_08_self_att_ln_K__chunk_shifted___1_sliced", "T"),
            ("conformer_block_08_self_att_ln_K__chunk_shifted___sliced", "T"),
            ("conformer_block_08_self_att_ln_K", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_08_self_att_ln_Q": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_08_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_08_self_att_ln_Q_H": {
        "class": "combine",
        "from": [
            "conformer_block_08_self_att_ln_Q_H_",
            "conformer_block_08_self_att_Q_energy_factor",
        ],
        "kind": "mul",
    },
    "conformer_block_08_self_att_ln_Q_H_": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_08_self_att_ln_Q",
    },
    "conformer_block_08_self_att_ln_V": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_08_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_08_self_att_ln_V_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_08_self_att_ln_V_concat",
    },
    "conformer_block_08_self_att_ln_V__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_08_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_08_self_att_ln_V__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_08_self_att_ln_V__chunk_shifted",
    },
    "conformer_block_08_self_att_ln_V__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_08_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_08_self_att_ln_V__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_08_self_att_ln_V__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_08_self_att_ln_V__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_08_self_att_ln_V__chunk_shifted_1",
    },
    "conformer_block_08_self_att_ln_V__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_08_self_att_ln_V__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_08_self_att_ln_V__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_08_self_att_ln_V__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_08_self_att_ln_V__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_08_self_att_ln_V__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_08_self_att_ln_V__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_08_self_att_ln_V",
    },
    "conformer_block_08_self_att_ln_V_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_08_self_att_ln_V__chunk_shifted___1_sliced", "T"),
            ("conformer_block_08_self_att_ln_V__chunk_shifted___sliced", "T"),
            ("conformer_block_08_self_att_ln_V", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_08_self_att_ln_att": {
        "class": "reinterpret_data",
        "from": "conformer_block_08_self_att_ln_att_",
        "set_axes": {"T": "dim:35"},
    },
    "conformer_block_08_self_att_ln_att0": {
        "class": "dot",
        "from": [
            "conformer_block_08_self_att_ln_weights_drop",
            "conformer_block_08_self_att_ln_V_H",
        ],
        "reduce": concat_window_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_08_self_att_ln_att_": {
        "axes": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "class": "merge_dims",
        "from": "conformer_block_08_self_att_ln_att0",
    },
    "conformer_block_08_self_att_ln_energy": {
        "class": "dot",
        "from": [
            "conformer_block_08_self_att_ln_K_H",
            "conformer_block_08_self_att_ln_Q_H",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_08_self_att_ln_energy_": {
        "allow_broadcast_all_sources": False,
        "class": "combine",
        "from": [
            "conformer_block_08_self_att_ln_energy",
            "conformer_block_08_self_att_ln_energy_rel_pos",
        ],
        "kind": "add",
    },
    "conformer_block_08_self_att_ln_energy_rel_pos": {
        "class": "dot",
        "from": [
            "conformer_block_08_self_att_ln_Q_H",
            "conformer_block_08_self_att_ln_rel_pos_enc",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_08_self_att_ln_rel_pos_enc": {
        "class": "relative_positional_encoding",
        "clipping": 16,
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_08_self_att_ln_K_concat",
        "key_value_spatial_dim": concat_window_dim,
        "out_dim": enc_dim_per_head_dim,
        "query_offset": 70,
        "query_spatial_dim": chunk_size_dim,
    },
    "conformer_block_08_self_att_ln_weights": {
        "class": "softmax_over_spatial",
        "from": "conformer_block_08_self_att_ln_energy_",
    },
    "conformer_block_08_self_att_ln_weights_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "dropout_noise_shape": {"*": None},
        "from": "conformer_block_08_self_att_ln_weights",
    },
    "conformer_block_08_self_att_res": {
        "class": "combine",
        "from": [
            "conformer_block_08_self_att_dropout",
            "conformer_block_08_ffmod_1_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_09": {"class": "copy", "from": "conformer_block_09_ln"},
    "conformer_block_09_conv_mod_bn": {
        "class": "batch_norm",
        "delay_sample_update": True,
        "epsilon": 0.001,
        "from": "conformer_block_09_conv_mod_depthwise_conv_slice",
        "momentum": 0.1,
        "update_sample_only_in_training": True,
    },
    "conformer_block_09_conv_mod_depthwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "conv",
        "filter_size": (32,),
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_09_conv_mod_glu_act_concat",
        "groups": 512,
        "n_out": 512,
        "padding": "same",
        "with_bias": True,
    },
    "conformer_block_09_conv_mod_depthwise_conv_slice": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_09_conv_mod_depthwise_conv2",
        "slice_start": 40,
    },
    "conformer_block_09_conv_mod_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_09_conv_mod_pointwise_conv2",
    },
    "conformer_block_09_conv_mod_glu": {
        "activation": "identity",
        "class": "gating",
        "from": "conformer_block_09_conv_mod_pointwise_conv1",
    },
    "conformer_block_09_conv_mod_glu_act_chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_09_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_09_conv_mod_glu_act_chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_09_conv_mod_glu_act_chunk_shifted",
    },
    "conformer_block_09_conv_mod_glu_act_chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_09_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_09_conv_mod_glu_act_chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_09_conv_mod_glu_act_chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_09_conv_mod_glu_act_chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_09_conv_mod_glu_act_chunk_shifted_1",
    },
    "conformer_block_09_conv_mod_glu_act_chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_09_conv_mod_glu_act_chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_09_conv_mod_glu_act_chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_09_conv_mod_glu_act_chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_09_conv_mod_glu_act_chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_09_conv_mod_glu_act_chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_09_conv_mod_glu_act_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_09_conv_mod_glu_act_chunk_shifted___1_sliced", "T"),
            ("conformer_block_09_conv_mod_glu_act_chunk_shifted___sliced", "T"),
            ("conformer_block_09_conv_mod_glu", "T"),
        ],
        "out_dim": conv_cache_concat_dim,
    },
    "conformer_block_09_conv_mod_glu_act_split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_09_conv_mod_glu",
    },
    "conformer_block_09_conv_mod_ln": {
        "class": "layer_norm",
        "from": "conformer_block_09_self_att_res",
    },
    "conformer_block_09_conv_mod_pointwise_conv1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_09_conv_mod_ln",
        "n_out": 1024,
        "with_bias": True,
    },
    "conformer_block_09_conv_mod_pointwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_09_conv_mod_swish",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_09_conv_mod_res": {
        "class": "combine",
        "from": ["conformer_block_09_conv_mod_drop", "conformer_block_09_self_att_res"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_09_conv_mod_swish": {
        "activation": "swish",
        "class": "activation",
        "from": "conformer_block_09_conv_mod_bn",
    },
    "conformer_block_09_ffmod_1_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_09_ffmod_1_square_relu",
    },
    "conformer_block_09_ffmod_1_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_09_ffmod_1_ff2",
    },
    "conformer_block_09_ffmod_1_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_09_ffmod_1_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_09_ffmod_1_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_09_ffmod_1_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_09_ffmod_1_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_09_ffmod_1_drop2",
    },
    "conformer_block_09_ffmod_1_ln": {
        "class": "layer_norm",
        "from": "conformer_block_08",
    },
    "conformer_block_09_ffmod_1_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_09_ffmod_1_ff1",
    },
    "conformer_block_09_ffmod_1_res": {
        "class": "combine",
        "from": ["conformer_block_09_ffmod_1_half_step", "conformer_block_08"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_09_ffmod_1_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_09_ffmod_1_relu",
    },
    "conformer_block_09_ffmod_2_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_09_ffmod_2_square_relu",
    },
    "conformer_block_09_ffmod_2_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_09_ffmod_2_ff2",
    },
    "conformer_block_09_ffmod_2_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_09_ffmod_2_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_09_ffmod_2_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_09_ffmod_2_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_09_ffmod_2_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_09_ffmod_2_drop2",
    },
    "conformer_block_09_ffmod_2_ln": {
        "class": "layer_norm",
        "from": "conformer_block_09_conv_mod_res",
    },
    "conformer_block_09_ffmod_2_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_09_ffmod_2_ff1",
    },
    "conformer_block_09_ffmod_2_res": {
        "class": "combine",
        "from": [
            "conformer_block_09_ffmod_2_half_step",
            "conformer_block_09_conv_mod_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_09_ffmod_2_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_09_ffmod_2_relu",
    },
    "conformer_block_09_ln": {
        "class": "layer_norm",
        "from": "conformer_block_09_ffmod_2_res",
    },
    "conformer_block_09_self_att_Q_energy_factor": {
        "class": "eval",
        "eval": "source(0) ** -0.5",
        "from": "conformer_block_09_self_att_dim_per_head_const",
    },
    "conformer_block_09_self_att_dim_per_head_const": {
        "class": "constant",
        "dtype": "float32",
        "value": 64,
    },
    "conformer_block_09_self_att_dropout": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_09_self_att_linear",
    },
    "conformer_block_09_self_att_linear": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_09_self_att_ln_att",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_09_self_att_ln": {
        "class": "layer_norm",
        "from": "conformer_block_09_ffmod_1_res",
    },
    "conformer_block_09_self_att_ln_K": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_09_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_09_self_att_ln_K_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_09_self_att_ln_K_concat",
    },
    "conformer_block_09_self_att_ln_K__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_09_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_09_self_att_ln_K__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_09_self_att_ln_K__chunk_shifted",
    },
    "conformer_block_09_self_att_ln_K__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_09_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_09_self_att_ln_K__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_09_self_att_ln_K__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_09_self_att_ln_K__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_09_self_att_ln_K__chunk_shifted_1",
    },
    "conformer_block_09_self_att_ln_K__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_09_self_att_ln_K__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_09_self_att_ln_K__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_09_self_att_ln_K__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_09_self_att_ln_K__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_09_self_att_ln_K__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_09_self_att_ln_K__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_09_self_att_ln_K",
    },
    "conformer_block_09_self_att_ln_K_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_09_self_att_ln_K__chunk_shifted___1_sliced", "T"),
            ("conformer_block_09_self_att_ln_K__chunk_shifted___sliced", "T"),
            ("conformer_block_09_self_att_ln_K", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_09_self_att_ln_Q": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_09_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_09_self_att_ln_Q_H": {
        "class": "combine",
        "from": [
            "conformer_block_09_self_att_ln_Q_H_",
            "conformer_block_09_self_att_Q_energy_factor",
        ],
        "kind": "mul",
    },
    "conformer_block_09_self_att_ln_Q_H_": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_09_self_att_ln_Q",
    },
    "conformer_block_09_self_att_ln_V": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_09_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_09_self_att_ln_V_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_09_self_att_ln_V_concat",
    },
    "conformer_block_09_self_att_ln_V__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_09_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_09_self_att_ln_V__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_09_self_att_ln_V__chunk_shifted",
    },
    "conformer_block_09_self_att_ln_V__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_09_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_09_self_att_ln_V__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_09_self_att_ln_V__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_09_self_att_ln_V__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_09_self_att_ln_V__chunk_shifted_1",
    },
    "conformer_block_09_self_att_ln_V__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_09_self_att_ln_V__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_09_self_att_ln_V__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_09_self_att_ln_V__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_09_self_att_ln_V__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_09_self_att_ln_V__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_09_self_att_ln_V__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_09_self_att_ln_V",
    },
    "conformer_block_09_self_att_ln_V_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_09_self_att_ln_V__chunk_shifted___1_sliced", "T"),
            ("conformer_block_09_self_att_ln_V__chunk_shifted___sliced", "T"),
            ("conformer_block_09_self_att_ln_V", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_09_self_att_ln_att": {
        "class": "reinterpret_data",
        "from": "conformer_block_09_self_att_ln_att_",
        "set_axes": {"T": "dim:35"},
    },
    "conformer_block_09_self_att_ln_att0": {
        "class": "dot",
        "from": [
            "conformer_block_09_self_att_ln_weights_drop",
            "conformer_block_09_self_att_ln_V_H",
        ],
        "reduce": concat_window_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_09_self_att_ln_att_": {
        "axes": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "class": "merge_dims",
        "from": "conformer_block_09_self_att_ln_att0",
    },
    "conformer_block_09_self_att_ln_energy": {
        "class": "dot",
        "from": [
            "conformer_block_09_self_att_ln_K_H",
            "conformer_block_09_self_att_ln_Q_H",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_09_self_att_ln_energy_": {
        "allow_broadcast_all_sources": False,
        "class": "combine",
        "from": [
            "conformer_block_09_self_att_ln_energy",
            "conformer_block_09_self_att_ln_energy_rel_pos",
        ],
        "kind": "add",
    },
    "conformer_block_09_self_att_ln_energy_rel_pos": {
        "class": "dot",
        "from": [
            "conformer_block_09_self_att_ln_Q_H",
            "conformer_block_09_self_att_ln_rel_pos_enc",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_09_self_att_ln_rel_pos_enc": {
        "class": "relative_positional_encoding",
        "clipping": 16,
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_09_self_att_ln_K_concat",
        "key_value_spatial_dim": concat_window_dim,
        "out_dim": enc_dim_per_head_dim,
        "query_offset": 70,
        "query_spatial_dim": chunk_size_dim,
    },
    "conformer_block_09_self_att_ln_weights": {
        "class": "softmax_over_spatial",
        "from": "conformer_block_09_self_att_ln_energy_",
    },
    "conformer_block_09_self_att_ln_weights_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "dropout_noise_shape": {"*": None},
        "from": "conformer_block_09_self_att_ln_weights",
    },
    "conformer_block_09_self_att_res": {
        "class": "combine",
        "from": [
            "conformer_block_09_self_att_dropout",
            "conformer_block_09_ffmod_1_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_10": {"class": "copy", "from": "conformer_block_10_ln"},
    "conformer_block_10_conv_mod_bn": {
        "class": "batch_norm",
        "delay_sample_update": True,
        "epsilon": 0.001,
        "from": "conformer_block_10_conv_mod_depthwise_conv_slice",
        "momentum": 0.1,
        "update_sample_only_in_training": True,
    },
    "conformer_block_10_conv_mod_depthwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "conv",
        "filter_size": (32,),
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_10_conv_mod_glu_act_concat",
        "groups": 512,
        "n_out": 512,
        "padding": "same",
        "with_bias": True,
    },
    "conformer_block_10_conv_mod_depthwise_conv_slice": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_10_conv_mod_depthwise_conv2",
        "slice_start": 40,
    },
    "conformer_block_10_conv_mod_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_10_conv_mod_pointwise_conv2",
    },
    "conformer_block_10_conv_mod_glu": {
        "activation": "identity",
        "class": "gating",
        "from": "conformer_block_10_conv_mod_pointwise_conv1",
    },
    "conformer_block_10_conv_mod_glu_act_chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_10_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_10_conv_mod_glu_act_chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_10_conv_mod_glu_act_chunk_shifted",
    },
    "conformer_block_10_conv_mod_glu_act_chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_10_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_10_conv_mod_glu_act_chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_10_conv_mod_glu_act_chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_10_conv_mod_glu_act_chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_10_conv_mod_glu_act_chunk_shifted_1",
    },
    "conformer_block_10_conv_mod_glu_act_chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_10_conv_mod_glu_act_chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_10_conv_mod_glu_act_chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_10_conv_mod_glu_act_chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_10_conv_mod_glu_act_chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_10_conv_mod_glu_act_chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_10_conv_mod_glu_act_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_10_conv_mod_glu_act_chunk_shifted___1_sliced", "T"),
            ("conformer_block_10_conv_mod_glu_act_chunk_shifted___sliced", "T"),
            ("conformer_block_10_conv_mod_glu", "T"),
        ],
        "out_dim": conv_cache_concat_dim,
    },
    "conformer_block_10_conv_mod_glu_act_split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_10_conv_mod_glu",
    },
    "conformer_block_10_conv_mod_ln": {
        "class": "layer_norm",
        "from": "conformer_block_10_self_att_res",
    },
    "conformer_block_10_conv_mod_pointwise_conv1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_10_conv_mod_ln",
        "n_out": 1024,
        "with_bias": True,
    },
    "conformer_block_10_conv_mod_pointwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_10_conv_mod_swish",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_10_conv_mod_res": {
        "class": "combine",
        "from": ["conformer_block_10_conv_mod_drop", "conformer_block_10_self_att_res"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_10_conv_mod_swish": {
        "activation": "swish",
        "class": "activation",
        "from": "conformer_block_10_conv_mod_bn",
    },
    "conformer_block_10_ffmod_1_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_10_ffmod_1_square_relu",
    },
    "conformer_block_10_ffmod_1_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_10_ffmod_1_ff2",
    },
    "conformer_block_10_ffmod_1_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_10_ffmod_1_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_10_ffmod_1_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_10_ffmod_1_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_10_ffmod_1_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_10_ffmod_1_drop2",
    },
    "conformer_block_10_ffmod_1_ln": {
        "class": "layer_norm",
        "from": "conformer_block_09",
    },
    "conformer_block_10_ffmod_1_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_10_ffmod_1_ff1",
    },
    "conformer_block_10_ffmod_1_res": {
        "class": "combine",
        "from": ["conformer_block_10_ffmod_1_half_step", "conformer_block_09"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_10_ffmod_1_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_10_ffmod_1_relu",
    },
    "conformer_block_10_ffmod_2_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_10_ffmod_2_square_relu",
    },
    "conformer_block_10_ffmod_2_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_10_ffmod_2_ff2",
    },
    "conformer_block_10_ffmod_2_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_10_ffmod_2_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_10_ffmod_2_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_10_ffmod_2_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_10_ffmod_2_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_10_ffmod_2_drop2",
    },
    "conformer_block_10_ffmod_2_ln": {
        "class": "layer_norm",
        "from": "conformer_block_10_conv_mod_res",
    },
    "conformer_block_10_ffmod_2_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_10_ffmod_2_ff1",
    },
    "conformer_block_10_ffmod_2_res": {
        "class": "combine",
        "from": [
            "conformer_block_10_ffmod_2_half_step",
            "conformer_block_10_conv_mod_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_10_ffmod_2_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_10_ffmod_2_relu",
    },
    "conformer_block_10_ln": {
        "class": "layer_norm",
        "from": "conformer_block_10_ffmod_2_res",
    },
    "conformer_block_10_self_att_Q_energy_factor": {
        "class": "eval",
        "eval": "source(0) ** -0.5",
        "from": "conformer_block_10_self_att_dim_per_head_const",
    },
    "conformer_block_10_self_att_dim_per_head_const": {
        "class": "constant",
        "dtype": "float32",
        "value": 64,
    },
    "conformer_block_10_self_att_dropout": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_10_self_att_linear",
    },
    "conformer_block_10_self_att_linear": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_10_self_att_ln_att",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_10_self_att_ln": {
        "class": "layer_norm",
        "from": "conformer_block_10_ffmod_1_res",
    },
    "conformer_block_10_self_att_ln_K": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_10_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_10_self_att_ln_K_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_10_self_att_ln_K_concat",
    },
    "conformer_block_10_self_att_ln_K__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_10_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_10_self_att_ln_K__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_10_self_att_ln_K__chunk_shifted",
    },
    "conformer_block_10_self_att_ln_K__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_10_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_10_self_att_ln_K__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_10_self_att_ln_K__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_10_self_att_ln_K__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_10_self_att_ln_K__chunk_shifted_1",
    },
    "conformer_block_10_self_att_ln_K__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_10_self_att_ln_K__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_10_self_att_ln_K__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_10_self_att_ln_K__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_10_self_att_ln_K__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_10_self_att_ln_K__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_10_self_att_ln_K__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_10_self_att_ln_K",
    },
    "conformer_block_10_self_att_ln_K_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_10_self_att_ln_K__chunk_shifted___1_sliced", "T"),
            ("conformer_block_10_self_att_ln_K__chunk_shifted___sliced", "T"),
            ("conformer_block_10_self_att_ln_K", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_10_self_att_ln_Q": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_10_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_10_self_att_ln_Q_H": {
        "class": "combine",
        "from": [
            "conformer_block_10_self_att_ln_Q_H_",
            "conformer_block_10_self_att_Q_energy_factor",
        ],
        "kind": "mul",
    },
    "conformer_block_10_self_att_ln_Q_H_": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_10_self_att_ln_Q",
    },
    "conformer_block_10_self_att_ln_V": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_10_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_10_self_att_ln_V_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_10_self_att_ln_V_concat",
    },
    "conformer_block_10_self_att_ln_V__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_10_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_10_self_att_ln_V__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_10_self_att_ln_V__chunk_shifted",
    },
    "conformer_block_10_self_att_ln_V__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_10_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_10_self_att_ln_V__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_10_self_att_ln_V__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_10_self_att_ln_V__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_10_self_att_ln_V__chunk_shifted_1",
    },
    "conformer_block_10_self_att_ln_V__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_10_self_att_ln_V__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_10_self_att_ln_V__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_10_self_att_ln_V__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_10_self_att_ln_V__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_10_self_att_ln_V__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_10_self_att_ln_V__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_10_self_att_ln_V",
    },
    "conformer_block_10_self_att_ln_V_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_10_self_att_ln_V__chunk_shifted___1_sliced", "T"),
            ("conformer_block_10_self_att_ln_V__chunk_shifted___sliced", "T"),
            ("conformer_block_10_self_att_ln_V", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_10_self_att_ln_att": {
        "class": "reinterpret_data",
        "from": "conformer_block_10_self_att_ln_att_",
        "set_axes": {"T": "dim:35"},
    },
    "conformer_block_10_self_att_ln_att0": {
        "class": "dot",
        "from": [
            "conformer_block_10_self_att_ln_weights_drop",
            "conformer_block_10_self_att_ln_V_H",
        ],
        "reduce": concat_window_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_10_self_att_ln_att_": {
        "axes": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "class": "merge_dims",
        "from": "conformer_block_10_self_att_ln_att0",
    },
    "conformer_block_10_self_att_ln_energy": {
        "class": "dot",
        "from": [
            "conformer_block_10_self_att_ln_K_H",
            "conformer_block_10_self_att_ln_Q_H",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_10_self_att_ln_energy_": {
        "allow_broadcast_all_sources": False,
        "class": "combine",
        "from": [
            "conformer_block_10_self_att_ln_energy",
            "conformer_block_10_self_att_ln_energy_rel_pos",
        ],
        "kind": "add",
    },
    "conformer_block_10_self_att_ln_energy_rel_pos": {
        "class": "dot",
        "from": [
            "conformer_block_10_self_att_ln_Q_H",
            "conformer_block_10_self_att_ln_rel_pos_enc",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_10_self_att_ln_rel_pos_enc": {
        "class": "relative_positional_encoding",
        "clipping": 16,
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_10_self_att_ln_K_concat",
        "key_value_spatial_dim": concat_window_dim,
        "out_dim": enc_dim_per_head_dim,
        "query_offset": 70,
        "query_spatial_dim": chunk_size_dim,
    },
    "conformer_block_10_self_att_ln_weights": {
        "class": "softmax_over_spatial",
        "from": "conformer_block_10_self_att_ln_energy_",
    },
    "conformer_block_10_self_att_ln_weights_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "dropout_noise_shape": {"*": None},
        "from": "conformer_block_10_self_att_ln_weights",
    },
    "conformer_block_10_self_att_res": {
        "class": "combine",
        "from": [
            "conformer_block_10_self_att_dropout",
            "conformer_block_10_ffmod_1_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_11": {"class": "copy", "from": "conformer_block_11_ln"},
    "conformer_block_11_conv_mod_bn": {
        "class": "batch_norm",
        "delay_sample_update": True,
        "epsilon": 0.001,
        "from": "conformer_block_11_conv_mod_depthwise_conv_slice",
        "momentum": 0.1,
        "update_sample_only_in_training": True,
    },
    "conformer_block_11_conv_mod_depthwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "conv",
        "filter_size": (32,),
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_11_conv_mod_glu_act_concat",
        "groups": 512,
        "n_out": 512,
        "padding": "same",
        "with_bias": True,
    },
    "conformer_block_11_conv_mod_depthwise_conv_slice": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_11_conv_mod_depthwise_conv2",
        "slice_start": 40,
    },
    "conformer_block_11_conv_mod_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_11_conv_mod_pointwise_conv2",
    },
    "conformer_block_11_conv_mod_glu": {
        "activation": "identity",
        "class": "gating",
        "from": "conformer_block_11_conv_mod_pointwise_conv1",
    },
    "conformer_block_11_conv_mod_glu_act_chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_11_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_11_conv_mod_glu_act_chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_11_conv_mod_glu_act_chunk_shifted",
    },
    "conformer_block_11_conv_mod_glu_act_chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_11_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_11_conv_mod_glu_act_chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_11_conv_mod_glu_act_chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_11_conv_mod_glu_act_chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_11_conv_mod_glu_act_chunk_shifted_1",
    },
    "conformer_block_11_conv_mod_glu_act_chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_11_conv_mod_glu_act_chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_11_conv_mod_glu_act_chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_11_conv_mod_glu_act_chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_11_conv_mod_glu_act_chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_11_conv_mod_glu_act_chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_11_conv_mod_glu_act_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_11_conv_mod_glu_act_chunk_shifted___1_sliced", "T"),
            ("conformer_block_11_conv_mod_glu_act_chunk_shifted___sliced", "T"),
            ("conformer_block_11_conv_mod_glu", "T"),
        ],
        "out_dim": conv_cache_concat_dim,
    },
    "conformer_block_11_conv_mod_glu_act_split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_11_conv_mod_glu",
    },
    "conformer_block_11_conv_mod_ln": {
        "class": "layer_norm",
        "from": "conformer_block_11_self_att_res",
    },
    "conformer_block_11_conv_mod_pointwise_conv1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_11_conv_mod_ln",
        "n_out": 1024,
        "with_bias": True,
    },
    "conformer_block_11_conv_mod_pointwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_11_conv_mod_swish",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_11_conv_mod_res": {
        "class": "combine",
        "from": ["conformer_block_11_conv_mod_drop", "conformer_block_11_self_att_res"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_11_conv_mod_swish": {
        "activation": "swish",
        "class": "activation",
        "from": "conformer_block_11_conv_mod_bn",
    },
    "conformer_block_11_ffmod_1_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_11_ffmod_1_square_relu",
    },
    "conformer_block_11_ffmod_1_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_11_ffmod_1_ff2",
    },
    "conformer_block_11_ffmod_1_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_11_ffmod_1_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_11_ffmod_1_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_11_ffmod_1_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_11_ffmod_1_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_11_ffmod_1_drop2",
    },
    "conformer_block_11_ffmod_1_ln": {
        "class": "layer_norm",
        "from": "conformer_block_10",
    },
    "conformer_block_11_ffmod_1_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_11_ffmod_1_ff1",
    },
    "conformer_block_11_ffmod_1_res": {
        "class": "combine",
        "from": ["conformer_block_11_ffmod_1_half_step", "conformer_block_10"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_11_ffmod_1_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_11_ffmod_1_relu",
    },
    "conformer_block_11_ffmod_2_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_11_ffmod_2_square_relu",
    },
    "conformer_block_11_ffmod_2_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_11_ffmod_2_ff2",
    },
    "conformer_block_11_ffmod_2_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_11_ffmod_2_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_11_ffmod_2_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_11_ffmod_2_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_11_ffmod_2_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_11_ffmod_2_drop2",
    },
    "conformer_block_11_ffmod_2_ln": {
        "class": "layer_norm",
        "from": "conformer_block_11_conv_mod_res",
    },
    "conformer_block_11_ffmod_2_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_11_ffmod_2_ff1",
    },
    "conformer_block_11_ffmod_2_res": {
        "class": "combine",
        "from": [
            "conformer_block_11_ffmod_2_half_step",
            "conformer_block_11_conv_mod_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_11_ffmod_2_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_11_ffmod_2_relu",
    },
    "conformer_block_11_ln": {
        "class": "layer_norm",
        "from": "conformer_block_11_ffmod_2_res",
    },
    "conformer_block_11_self_att_Q_energy_factor": {
        "class": "eval",
        "eval": "source(0) ** -0.5",
        "from": "conformer_block_11_self_att_dim_per_head_const",
    },
    "conformer_block_11_self_att_dim_per_head_const": {
        "class": "constant",
        "dtype": "float32",
        "value": 64,
    },
    "conformer_block_11_self_att_dropout": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_11_self_att_linear",
    },
    "conformer_block_11_self_att_linear": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_11_self_att_ln_att",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_11_self_att_ln": {
        "class": "layer_norm",
        "from": "conformer_block_11_ffmod_1_res",
    },
    "conformer_block_11_self_att_ln_K": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_11_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_11_self_att_ln_K_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_11_self_att_ln_K_concat",
    },
    "conformer_block_11_self_att_ln_K__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_11_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_11_self_att_ln_K__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_11_self_att_ln_K__chunk_shifted",
    },
    "conformer_block_11_self_att_ln_K__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_11_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_11_self_att_ln_K__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_11_self_att_ln_K__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_11_self_att_ln_K__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_11_self_att_ln_K__chunk_shifted_1",
    },
    "conformer_block_11_self_att_ln_K__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_11_self_att_ln_K__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_11_self_att_ln_K__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_11_self_att_ln_K__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_11_self_att_ln_K__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_11_self_att_ln_K__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_11_self_att_ln_K__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_11_self_att_ln_K",
    },
    "conformer_block_11_self_att_ln_K_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_11_self_att_ln_K__chunk_shifted___1_sliced", "T"),
            ("conformer_block_11_self_att_ln_K__chunk_shifted___sliced", "T"),
            ("conformer_block_11_self_att_ln_K", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_11_self_att_ln_Q": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_11_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_11_self_att_ln_Q_H": {
        "class": "combine",
        "from": [
            "conformer_block_11_self_att_ln_Q_H_",
            "conformer_block_11_self_att_Q_energy_factor",
        ],
        "kind": "mul",
    },
    "conformer_block_11_self_att_ln_Q_H_": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_11_self_att_ln_Q",
    },
    "conformer_block_11_self_att_ln_V": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_11_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_11_self_att_ln_V_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_11_self_att_ln_V_concat",
    },
    "conformer_block_11_self_att_ln_V__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_11_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_11_self_att_ln_V__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_11_self_att_ln_V__chunk_shifted",
    },
    "conformer_block_11_self_att_ln_V__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_11_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_11_self_att_ln_V__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_11_self_att_ln_V__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_11_self_att_ln_V__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_11_self_att_ln_V__chunk_shifted_1",
    },
    "conformer_block_11_self_att_ln_V__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_11_self_att_ln_V__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_11_self_att_ln_V__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_11_self_att_ln_V__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_11_self_att_ln_V__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_11_self_att_ln_V__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_11_self_att_ln_V__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_11_self_att_ln_V",
    },
    "conformer_block_11_self_att_ln_V_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_11_self_att_ln_V__chunk_shifted___1_sliced", "T"),
            ("conformer_block_11_self_att_ln_V__chunk_shifted___sliced", "T"),
            ("conformer_block_11_self_att_ln_V", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_11_self_att_ln_att": {
        "class": "reinterpret_data",
        "from": "conformer_block_11_self_att_ln_att_",
        "set_axes": {"T": "dim:35"},
    },
    "conformer_block_11_self_att_ln_att0": {
        "class": "dot",
        "from": [
            "conformer_block_11_self_att_ln_weights_drop",
            "conformer_block_11_self_att_ln_V_H",
        ],
        "reduce": concat_window_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_11_self_att_ln_att_": {
        "axes": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "class": "merge_dims",
        "from": "conformer_block_11_self_att_ln_att0",
    },
    "conformer_block_11_self_att_ln_energy": {
        "class": "dot",
        "from": [
            "conformer_block_11_self_att_ln_K_H",
            "conformer_block_11_self_att_ln_Q_H",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_11_self_att_ln_energy_": {
        "allow_broadcast_all_sources": False,
        "class": "combine",
        "from": [
            "conformer_block_11_self_att_ln_energy",
            "conformer_block_11_self_att_ln_energy_rel_pos",
        ],
        "kind": "add",
    },
    "conformer_block_11_self_att_ln_energy_rel_pos": {
        "class": "dot",
        "from": [
            "conformer_block_11_self_att_ln_Q_H",
            "conformer_block_11_self_att_ln_rel_pos_enc",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_11_self_att_ln_rel_pos_enc": {
        "class": "relative_positional_encoding",
        "clipping": 16,
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_11_self_att_ln_K_concat",
        "key_value_spatial_dim": concat_window_dim,
        "out_dim": enc_dim_per_head_dim,
        "query_offset": 70,
        "query_spatial_dim": chunk_size_dim,
    },
    "conformer_block_11_self_att_ln_weights": {
        "class": "softmax_over_spatial",
        "from": "conformer_block_11_self_att_ln_energy_",
    },
    "conformer_block_11_self_att_ln_weights_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "dropout_noise_shape": {"*": None},
        "from": "conformer_block_11_self_att_ln_weights",
    },
    "conformer_block_11_self_att_res": {
        "class": "combine",
        "from": [
            "conformer_block_11_self_att_dropout",
            "conformer_block_11_ffmod_1_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_12": {"class": "copy", "from": "conformer_block_12_ln"},
    "conformer_block_12_conv_mod_bn": {
        "class": "batch_norm",
        "delay_sample_update": True,
        "epsilon": 0.001,
        "from": "conformer_block_12_conv_mod_depthwise_conv_slice",
        "momentum": 0.1,
        "update_sample_only_in_training": True,
    },
    "conformer_block_12_conv_mod_depthwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "conv",
        "filter_size": (32,),
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_12_conv_mod_glu_act_concat",
        "groups": 512,
        "n_out": 512,
        "padding": "same",
        "with_bias": True,
    },
    "conformer_block_12_conv_mod_depthwise_conv_slice": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_12_conv_mod_depthwise_conv2",
        "slice_start": 40,
    },
    "conformer_block_12_conv_mod_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_12_conv_mod_pointwise_conv2",
    },
    "conformer_block_12_conv_mod_glu": {
        "activation": "identity",
        "class": "gating",
        "from": "conformer_block_12_conv_mod_pointwise_conv1",
    },
    "conformer_block_12_conv_mod_glu_act_chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_12_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_12_conv_mod_glu_act_chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_12_conv_mod_glu_act_chunk_shifted",
    },
    "conformer_block_12_conv_mod_glu_act_chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_12_conv_mod_glu_act_split_chunk",
        "pad": True,
    },
    "conformer_block_12_conv_mod_glu_act_chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_12_conv_mod_glu_act_chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_12_conv_mod_glu_act_chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_12_conv_mod_glu_act_chunk_shifted_1",
    },
    "conformer_block_12_conv_mod_glu_act_chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_12_conv_mod_glu_act_chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_12_conv_mod_glu_act_chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_12_conv_mod_glu_act_chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_12_conv_mod_glu_act_chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_12_conv_mod_glu_act_chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_12_conv_mod_glu_act_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_12_conv_mod_glu_act_chunk_shifted___1_sliced", "T"),
            ("conformer_block_12_conv_mod_glu_act_chunk_shifted___sliced", "T"),
            ("conformer_block_12_conv_mod_glu", "T"),
        ],
        "out_dim": conv_cache_concat_dim,
    },
    "conformer_block_12_conv_mod_glu_act_split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_12_conv_mod_glu",
    },
    "conformer_block_12_conv_mod_ln": {
        "class": "layer_norm",
        "from": "conformer_block_12_self_att_res",
    },
    "conformer_block_12_conv_mod_pointwise_conv1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_12_conv_mod_ln",
        "n_out": 1024,
        "with_bias": True,
    },
    "conformer_block_12_conv_mod_pointwise_conv2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_12_conv_mod_swish",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_12_conv_mod_res": {
        "class": "combine",
        "from": ["conformer_block_12_conv_mod_drop", "conformer_block_12_self_att_res"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_12_conv_mod_swish": {
        "activation": "swish",
        "class": "activation",
        "from": "conformer_block_12_conv_mod_bn",
    },
    "conformer_block_12_ffmod_1_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_12_ffmod_1_square_relu",
    },
    "conformer_block_12_ffmod_1_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_12_ffmod_1_ff2",
    },
    "conformer_block_12_ffmod_1_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_12_ffmod_1_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_12_ffmod_1_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_12_ffmod_1_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_12_ffmod_1_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_12_ffmod_1_drop2",
    },
    "conformer_block_12_ffmod_1_ln": {
        "class": "layer_norm",
        "from": "conformer_block_11",
    },
    "conformer_block_12_ffmod_1_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_12_ffmod_1_ff1",
    },
    "conformer_block_12_ffmod_1_res": {
        "class": "combine",
        "from": ["conformer_block_12_ffmod_1_half_step", "conformer_block_11"],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_12_ffmod_1_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_12_ffmod_1_relu",
    },
    "conformer_block_12_ffmod_2_drop1": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_12_ffmod_2_square_relu",
    },
    "conformer_block_12_ffmod_2_drop2": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_12_ffmod_2_ff2",
    },
    "conformer_block_12_ffmod_2_ff1": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_12_ffmod_2_ln",
        "n_out": 2048,
        "with_bias": True,
    },
    "conformer_block_12_ffmod_2_ff2": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_12_ffmod_2_drop1",
        "n_out": 512,
        "with_bias": True,
    },
    "conformer_block_12_ffmod_2_half_step": {
        "class": "eval",
        "eval": "0.5 * source(0)",
        "from": "conformer_block_12_ffmod_2_drop2",
    },
    "conformer_block_12_ffmod_2_ln": {
        "class": "layer_norm",
        "from": "conformer_block_12_conv_mod_res",
    },
    "conformer_block_12_ffmod_2_relu": {
        "activation": "relu",
        "class": "activation",
        "from": "conformer_block_12_ffmod_2_ff1",
    },
    "conformer_block_12_ffmod_2_res": {
        "class": "combine",
        "from": [
            "conformer_block_12_ffmod_2_half_step",
            "conformer_block_12_conv_mod_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conformer_block_12_ffmod_2_square_relu": {
        "class": "eval",
        "eval": "source(0) ** 2",
        "from": "conformer_block_12_ffmod_2_relu",
    },
    "conformer_block_12_ln": {
        "class": "layer_norm",
        "from": "conformer_block_12_ffmod_2_res",
    },
    "conformer_block_12_self_att_Q_energy_factor": {
        "class": "eval",
        "eval": "source(0) ** -0.5",
        "from": "conformer_block_12_self_att_dim_per_head_const",
    },
    "conformer_block_12_self_att_dim_per_head_const": {
        "class": "constant",
        "dtype": "float32",
        "value": 64,
    },
    "conformer_block_12_self_att_dropout": {
        "class": "dropout",
        "dropout": 0.1,
        "from": "conformer_block_12_self_att_linear",
    },
    "conformer_block_12_self_att_linear": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conformer_block_12_self_att_ln_att",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_12_self_att_ln": {
        "class": "layer_norm",
        "from": "conformer_block_12_ffmod_1_res",
    },
    "conformer_block_12_self_att_ln_K": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_12_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_12_self_att_ln_K_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_12_self_att_ln_K_concat",
    },
    "conformer_block_12_self_att_ln_K__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_12_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_12_self_att_ln_K__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_12_self_att_ln_K__chunk_shifted",
    },
    "conformer_block_12_self_att_ln_K__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_12_self_att_ln_K__split_chunk",
        "pad": True,
    },
    "conformer_block_12_self_att_ln_K__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_12_self_att_ln_K__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_12_self_att_ln_K__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_12_self_att_ln_K__chunk_shifted_1",
    },
    "conformer_block_12_self_att_ln_K__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_12_self_att_ln_K__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_12_self_att_ln_K__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_12_self_att_ln_K__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_12_self_att_ln_K__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_12_self_att_ln_K__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_12_self_att_ln_K__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_12_self_att_ln_K",
    },
    "conformer_block_12_self_att_ln_K_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_12_self_att_ln_K__chunk_shifted___1_sliced", "T"),
            ("conformer_block_12_self_att_ln_K__chunk_shifted___sliced", "T"),
            ("conformer_block_12_self_att_ln_K", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_12_self_att_ln_Q": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_12_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_12_self_att_ln_Q_H": {
        "class": "combine",
        "from": [
            "conformer_block_12_self_att_ln_Q_H_",
            "conformer_block_12_self_att_Q_energy_factor",
        ],
        "kind": "mul",
    },
    "conformer_block_12_self_att_ln_Q_H_": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_12_self_att_ln_Q",
    },
    "conformer_block_12_self_att_ln_V": {
        "L2": 0.0,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=0.5)",
        "from": "conformer_block_12_self_att_ln",
        "n_out": 512,
        "with_bias": False,
    },
    "conformer_block_12_self_att_ln_V_H": {
        "axis": "f",
        "class": "split_dims",
        "dims": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "from": "conformer_block_12_self_att_ln_V_concat",
    },
    "conformer_block_12_self_att_ln_V__chunk_shifted": {
        "adjust_size_info": False,
        "amount": 1,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_12_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_12_self_att_ln_V__chunk_shifted_": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_12_self_att_ln_V__chunk_shifted",
    },
    "conformer_block_12_self_att_ln_V__chunk_shifted_1": {
        "adjust_size_info": False,
        "amount": 2,
        "axis": chunked_time_dim,
        "class": "shift_axis",
        "from": "conformer_block_12_self_att_ln_V__split_chunk",
        "pad": True,
    },
    "conformer_block_12_self_att_ln_V__chunk_shifted__": {
        "class": "reinterpret_data",
        "from": "conformer_block_12_self_att_ln_V__chunk_shifted_",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_12_self_att_ln_V__chunk_shifted__1": {
        "axes": ("B", chunked_time_dim),
        "class": "merge_dims",
        "from": "conformer_block_12_self_att_ln_V__chunk_shifted_1",
    },
    "conformer_block_12_self_att_ln_V__chunk_shifted___1": {
        "class": "reinterpret_data",
        "from": "conformer_block_12_self_att_ln_V__chunk_shifted__1",
        "set_axes": {"T": "spatial"},
    },
    "conformer_block_12_self_att_ln_V__chunk_shifted___1_sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_12_self_att_ln_V__chunk_shifted___1",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_12_self_att_ln_V__chunk_shifted___sliced": {
        "axis": "T",
        "class": "slice",
        "from": "conformer_block_12_self_att_ln_V__chunk_shifted__",
        "slice_end": 20,
        "slice_start": 0,
    },
    "conformer_block_12_self_att_ln_V__split_chunk": {
        "base": "_input_chunked",
        "class": "split_batch_time",
        "from": "conformer_block_12_self_att_ln_V",
    },
    "conformer_block_12_self_att_ln_V_concat": {
        "class": "concat",
        "from": [
            ("conformer_block_12_self_att_ln_V__chunk_shifted___1_sliced", "T"),
            ("conformer_block_12_self_att_ln_V__chunk_shifted___sliced", "T"),
            ("conformer_block_12_self_att_ln_V", "T"),
        ],
        "out_dim": concat_window_dim,
    },
    "conformer_block_12_self_att_ln_att": {
        "class": "reinterpret_data",
        "from": "conformer_block_12_self_att_ln_att_",
        "set_axes": {"T": "dim:35"},
    },
    "conformer_block_12_self_att_ln_att0": {
        "class": "dot",
        "from": [
            "conformer_block_12_self_att_ln_weights_drop",
            "conformer_block_12_self_att_ln_V_H",
        ],
        "reduce": concat_window_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_12_self_att_ln_att_": {
        "axes": (enc_att_num_heads_dim, enc_dim_per_head_dim),
        "class": "merge_dims",
        "from": "conformer_block_12_self_att_ln_att0",
    },
    "conformer_block_12_self_att_ln_energy": {
        "class": "dot",
        "from": [
            "conformer_block_12_self_att_ln_K_H",
            "conformer_block_12_self_att_ln_Q_H",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_12_self_att_ln_energy_": {
        "allow_broadcast_all_sources": False,
        "class": "combine",
        "from": [
            "conformer_block_12_self_att_ln_energy",
            "conformer_block_12_self_att_ln_energy_rel_pos",
        ],
        "kind": "add",
    },
    "conformer_block_12_self_att_ln_energy_rel_pos": {
        "class": "dot",
        "from": [
            "conformer_block_12_self_att_ln_Q_H",
            "conformer_block_12_self_att_ln_rel_pos_enc",
        ],
        "reduce": enc_dim_per_head_dim,
        "var1": "auto",
        "var2": "auto",
    },
    "conformer_block_12_self_att_ln_rel_pos_enc": {
        "class": "relative_positional_encoding",
        "clipping": 16,
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', "
        "scale=1.0)",
        "from": "conformer_block_12_self_att_ln_K_concat",
        "key_value_spatial_dim": concat_window_dim,
        "out_dim": enc_dim_per_head_dim,
        "query_offset": 70,
        "query_spatial_dim": chunk_size_dim,
    },
    "conformer_block_12_self_att_ln_weights": {
        "class": "softmax_over_spatial",
        "from": "conformer_block_12_self_att_ln_energy_",
    },
    "conformer_block_12_self_att_ln_weights_drop": {
        "class": "dropout",
        "dropout": 0.1,
        "dropout_noise_shape": {"*": None},
        "from": "conformer_block_12_self_att_ln_weights",
    },
    "conformer_block_12_self_att_res": {
        "class": "combine",
        "from": [
            "conformer_block_12_self_att_dropout",
            "conformer_block_12_ffmod_1_res",
        ],
        "kind": "add",
        "n_out": 512,
    },
    "conv0": {
        "L2": 0.0001,
        "activation": "relu",
        "class": "conv",
        "filter_size": (3, 3),
        "from": "source0",
        "n_out": 32,
        "padding": "same",
        "with_bias": True,
    },
    "conv0p": {
        "class": "pool",
        "from": "conv0",
        "mode": "max",
        "padding": "same",
        "pool_size": (1, 2),
        "trainable": False,
    },
    "conv_merged": {
        "axes": [subsample_conv1_1_dim, subsample_conv1_out_dim],
        "class": "merge_dims",
        "from": "subsample_conv1",
        "keep_order": True,
    },
    "conv_out": {"class": "copy", "from": "conv0p"},
    "edit_distance": {
        "class": "copy",
        "from": "out_best_wo_blank",
        "loss": "edit_distance",
        "only_on_search": True,
        "target": "bpe_labels",
    },
    "enc_ctx": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "from": "encoder",
        "n_out": 1024,
        "with_bias": True,
    },
    "enc_seq_len": {"class": "length", "from": "encoder"},
    "enc_value": {
        "axis": "F",
        "class": "split_dims",
        "dims": (dec_att_num_heads_dim, val_dim),
        "from": "encoder",
    },
    "encoder": {
        "class": "reinterpret_data",
        "from": "___encoder",
        "set_axes": {"T": chunked_time_dim},
    },
    "encoder_full_seq": {"class": "copy", "from": "conformer_block_12"},
    "input_chunked": {
        "class": "reinterpret_data",
        "from": "__input_chunked",
        "set_axes": {"T": input_chunk_size_dim},
    },
    "inv_fertility": {
        "activation": "sigmoid",
        "class": "linear",
        "from": "encoder",
        "n_out": dec_att_num_heads_dim,
        "with_bias": False,
    },
    "log": {
        "activation": "safe_log",
        "class": "activation",
        "from": "mel_filterbank",
        "opts": {"eps": 1e-10},
    },
    "log10": {"class": "eval", "eval": "source(0) / 2.3026", "from": "log"},
    "log_mel_features": {"class": "copy", "from": "log10"},
    "mel_filterbank": {
        "class": "mel_filterbank",
        "fft_size": 512,
        "from": "power",
        "n_out": 80,
        "nr_of_filters": 80,
    },
    "out_best": {"class": "decide", "from": "output"},
    "out_best_non_blank_mask": {
        "class": "compare",
        "from": "out_best",
        "kind": "not_equal",
        "value": 0,
    },
    "out_best_seq_len": {"class": "length", "from": "out_best"},
    "out_best_wo_blank": {
        "class": "masked_computation",
        "from": "out_best",
        "mask": "out_best_non_blank_mask",
        "unit": {"class": "copy"},
    },
    "output": {
        "class": "rec",
        "from": [],
        "include_eos": True,
        "max_seq_len": "max_len_from('base:encoder') * 20",
        "target": "bpe_labels",
        "unit": {
            "att": {"axes": "static", "class": "merge_dims", "from": "att0"},
            "att0": {
                "class": "dot",
                "from": ["att_weights", "enc_value_set_time"],
                "reduce": sliced_chunk_size_dim,
                "var1": "auto",
                "var2": "auto",
            },
            "att_weights": {
                "axis": sliced_chunk_size_dim,
                "class": "softmax_over_spatial",
                "from": "energy",
            },
            "chunk_idx": {"class": "copy", "from": "prev:new_chunk_idx"},
            "chunk_idx_can_be_finished": {
                "class": "eval",
                "eval": "tf.logical_or(tf.logical_and(source(0), source(1)), tf.logical_not(source(0)))",
                "from": ["chunk_idx_reached_last", "label_pos_reached_end"],
            },
            "chunk_idx_reached_last": {
                "class": "compare",
                "from": ["chunk_idx", "last_chunk_idx"],
                "kind": "equal",
            },
            "enc_ctx_gather": {
                "axis": chunked_time_dim,
                "class": "gather",
                "clip_to_valid": True,
                "from": "base:enc_ctx",
                "position": "chunk_idx",
            },
            "enc_ctx_set_time": {
                "class": "reinterpret_data",
                "from": "enc_ctx_gather",
                "set_axes": {"T": sliced_chunk_size_dim},
            },
            "enc_value_gather": {
                "axis": chunked_time_dim,
                "class": "gather",
                "clip_to_valid": True,
                "from": "base:enc_value",
                "position": "chunk_idx",
            },
            "enc_value_set_time": {
                "class": "reinterpret_data",
                "from": "enc_value_gather",
                "set_axes": {"T": sliced_chunk_size_dim},
            },
            "end": {
                "class": "compare",
                "from": ["new_chunk_idx", "num_chunks"],
                "kind": "greater_equal",
            },
            "energy": {
                "L2": 0.0001,
                "activation": None,
                "class": "linear",
                "from": "energy_tanh",
                "n_out": 1,
                "out_dim": dec_att_num_heads_dim,
                "with_bias": False,
            },
            "energy_in": {
                "class": "combine",
                "from": ["enc_ctx_set_time", "s_transformed"],
                "kind": "add",
                "n_out": 1024,
            },
            "energy_tanh": {
                "activation": "tanh",
                "class": "activation",
                "from": "energy_in",
            },
            "ground_truth_label": {
                "axis": "T",
                "class": "gather",
                "clip_to_valid": True,
                "from": "base:data:bpe_labels",
                "position": "label_pos",
            },
            "ground_truth_label_seq_len": {
                "axis": "T",
                "class": "length",
                "from": "base:data:bpe_labels",
            },
            "ground_truth_last_label_pos": {
                "class": "eval",
                "eval": "source(0) - 1",
                "from": "ground_truth_label_seq_len",
            },
            "label_pos": {"class": "copy", "from": "prev:new_label_pos"},
            "label_pos_reached_end": {
                "class": "compare",
                "from": ["label_pos", "ground_truth_label_seq_len"],
                "kind": "greater_equal",
            },
            "last_chunk_idx": {
                "class": "eval",
                "eval": "source(0) - 1",
                "from": "num_chunks",
            },
            "new_chunk_idx": {
                "class": "eval",
                "eval": "tf.where(tf.equal(source(0), 0), source(1) + 1, source(1))",
                "from": ["output", "prev:new_chunk_idx"],
                "initial_output": 0,
                "out_type": {
                    "dim": None,
                    "dtype": "int32",
                    "sparse_dim": chunked_time_dim,
                },
            },
            "new_label_pos": {
                "class": "eval",
                "eval": "tf.where(tf.equal(source(0), 0), source(1), source(1) + 1)",
                "from": ["output", "prev:new_label_pos"],
                "initial_output": 0,
                "out_type": {
                    "dim": None,
                    "dtype": "int32",
                    "sparse_dim": chunked_time_dim,
                },
            },
            "num_chunks": {
                "axis": chunked_time_dim,
                "class": "length",
                "from": "base:encoder",
            },
            "output": {
                "beam_size": 12,
                "class": "choice",
                "from": "output_prob",
                "initial_output": 0,
                "target": "bpe_labels",
            },
            "output_prob": {
                "L2": 0.0001,
                "class": "softmax",
                "dropout": 0.3,
                "from": "readout",
                "loss": "ce",
                "loss_opts": {"label_smoothing": 0.1},
                "target": "bpe_labels",
            },
            "readout": {
                "class": "reduce_out",
                "from": "readout_in",
                "mode": "max",
                "num_pieces": 2,
            },
            "readout_in": {
                "L2": 0.0001,
                "activation": None,
                "class": "linear",
                "from": ["s", "prev:target_embed", "att"],
                "n_out": 1024,
                "with_bias": True,
            },
            "s": {
                "L2": 0.0001,
                "class": "rnn_cell",
                "from": ["prev:target_embed", "prev:att"],
                "n_out": 1024,
                "unit": "zoneoutlstm",
                "unit_opts": {
                    "zoneout_factor_cell": 0.15,
                    "zoneout_factor_output": 0.05,
                },
            },
            "s_transformed": {
                "L2": 0.0001,
                "activation": None,
                "class": "linear",
                "from": "s",
                "n_out": 1024,
                "with_bias": False,
            },
            "target_embed": {
                "class": "dropout",
                "dropout": 0.1,
                "dropout_noise_shape": {"*": None},
                "from": "target_embed0",
            },
            "target_embed0": {
                "L2": 0.0001,
                "activation": None,
                "class": "linear",
                "from": "output",
                "initial_output": 0,
                "n_out": 640,
                "with_bias": False,
            },
        },
    },
    "power": {"class": "eval", "eval": "source(0) ** 2", "from": "abs"},
    "source": {
        "class": "eval",
        "eval": "self.network.get_config().typed_value('transform')(source(0, as_data=True), network=self.network)",
        "from": "log_mel_features",
    },
    "source0": {
        "axis": "F",
        "class": "split_dims",
        "dims": (-1, 1),
        "from": "input_chunked",
    },
    "source_dropout": {"class": "dropout", "dropout": 0.1, "from": "source_linear"},
    "source_linear": {
        "L2": 0.0001,
        "activation": None,
        "class": "linear",
        "forward_weights_init": "variance_scaling_initializer(mode='fan_avg', distribution='uniform', scale=1.0)",
        "from": "conv_merged",
        "n_out": 512,
        "with_bias": False,
    },
    "stft": {
        "class": "stft",
        "fft_size": 512,
        "frame_shift": 160,
        "frame_size": 400,
        "from": "data:audio_features",
    },
    "subsample_conv0": {
        "L2": 0.0001,
        "activation": "relu",
        "class": "conv",
        "filter_size": (3, 3),
        "from": "conv_out",
        "n_out": 64,
        "out_dim": subsample_conv0_out_dim,
        "out_spatial_dims": [subsample_conv0_0_dim, subsample_conv0_1_dim],
        "padding": "same",
        "strides": (3, 1),
        "with_bias": True,
    },
    "subsample_conv1": {
        "L2": 0.0001,
        "activation": "relu",
        "class": "conv",
        "filter_size": (3, 3),
        "from": "subsample_conv0",
        "in_spatial_dims": [subsample_conv0_0_dim, subsample_conv0_1_dim],
        "n_out": 64,
        "out_dim": subsample_conv1_out_dim,
        "out_spatial_dims": [subsample_conv1_0_dim, subsample_conv1_1_dim],
        "padding": "same",
        "strides": (2, 1),
        "with_bias": True,
    },
    "targets_seq_len": {"class": "length", "from": "data:bpe_labels"},
}
newbob_learning_rate_decay = 0.9
newbob_multi_num_epochs = 20
newbob_multi_update_interval = 1
num_epochs = 300
optimizer_epsilon = 1e-08
preload_from_files = {
    "_01_retrain_checkpoint": {
        "custom_missing_load_func": load_qkv_mats,
        "filename": "/work/asr4/zeineldeen/setups-data/librispeech/2022-11-28--conformer-att/models-backup/best_att_100/avg_ckpt/epoch.2029",
        "init_for_train": True,
    }
}
save_interval = 1
search_output_layer = "out_best_wo_blank"
target = "classes"
task = "train"
tf_log_memory_usage = True
train = {
    "class": "MetaDataset",
    "data_map": {
        "audio_features": ("zip_dataset", "data"),
        "bpe_labels": ("chunk_hdf_dataset", "data"),
    },
    "datasets": {
        "chunk_hdf_dataset": {
            "class": "HDFDataset",
            "files": [
                "/u/zeineldeen/setups/ubuntu_22_setups/2023-06-14--streaming-conf/work/i6_core/returnn/forward/ReturnnForwardJob.UpMmmsEv1KDN/output/alignments-train.hdf"
            ],
            "partition_epoch": 1,
            "use_cache_manager": True,
        },
        "zip_dataset": {
            "audio": {
                "features": "raw",
                "peak_normalization": True,
                "preemphasis": None,
            },
            "class": "OggZipDataset",
            "partition_epoch": 20,
            "path": "/u/zeineldeen/setups/ubuntu_22_setups/2023-06-14--streaming-conf/work/i6_core/returnn/oggzip/BlissToOggZipJob.Cbboscd6En6A/output/out.ogg.zip",
            "segment_file": None,
            "seq_ordering": "laplace:.1000",
            "targets": None,
            "use_cache_manager": True,
        },
    },
    "seq_order_control_dataset": "zip_dataset",
}
truncation = -1
use_learning_rate_control_always = True
use_tensorflow = True
config = {}

locals().update(**config)

import sys

sys.setrecursionlimit(4000)
